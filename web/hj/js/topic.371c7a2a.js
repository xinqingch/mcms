(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["topic"],{"0478":function(t,e,i){"use strict";i("877b")},"07d8":function(t,e,i){},"0fae":function(t,e,i){},"11cb":function(t,e,i){"use strict";i("9f96")},"15e2":function(t,e,i){"use strict";i("d9ef")},"17c0":function(t,e,i){"use strict";i("3466")},"230c":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("base-header-layout",{on:{routerData:t.routerData}},[e("div",[e("div",{staticStyle:{"margin-bottom":""}},[e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_BTKEY}})],1),e("div",{staticClass:"post-card"},[e("div",{staticClass:"plate-header"},[e("div",{staticClass:"header-left"},[e("div",{staticClass:"title"},[t._v(t._s(t.currentPlate.name||""))]),t.favorite?e("div",{staticClass:"attention c-pointer disabled",staticStyle:{width:"81.56px"},on:{click:t.deleteFavorite}},[e("span",[t._v("已收藏"),e("i",{staticClass:"iconfont icon-gouxuan"})])]):e("div",{staticClass:"attention c-pointer",on:{click:t.addFavorite}},[e("span",[t._v("收藏本版 "),e("i",{staticClass:"el-icon-plus"})])]),e("div",{},[t._v(" 主帖数："),e("span",[t._v(t._s(t._f("showNumber")(t.articleDesc.topicCount)))])]),e("div",[t._v(" 回帖数："),e("span",[t._v(t._s(t._f("newshowNumber")(t.articleDesc.commentCount)))])])]),e("div",{staticClass:"header-right"},[e("div",{staticClass:"c-pointer",class:0==t.activeIndex?"active":"",on:{click:function(e){return t._notS(0)}}},[t._v("本版规则")]),e("div",{staticClass:"c-pointer",class:1==t.activeIndex?"active":"",on:{click:function(e){t.activeIndex=1}}},[t._v("本版介绍 ")]),e("div",{staticClass:"c-pointer",class:2==t.activeIndex?"active":"",on:{click:function(e){return t._notS(2)}}},[t._v("本版置顶")])])]),e("div",{staticClass:"screen-result"},[0===t.activeIndex?e("div",{staticClass:"container wrap-bd clearfix"},[e("div",{staticClass:"block-intro"},[e("div",{domProps:{innerHTML:t._s(t.articleDesc.topic_role)}})])]):t._e(),1===t.activeIndex?e("div",{staticClass:"container wrap-bd clearfix"},[e("div",{staticClass:"block-intro"},[e("div",{domProps:{innerHTML:t._s(t.articleDesc.description)}})])]):t._e(),2===t.activeIndex&&t.articleTopList.length>0?e("div",{staticClass:"container"},[e("a",{attrs:{href:"/post/details?pid="+t.articleTopList[0].topicId,title:t.articleTopList[0].title||""}},[t.articleTopList[0]&&t.articleTopList[0].attachments&&t.articleTopList[0].attachments.length>0?e("img",{directives:[{name:"lazyloadimg",rawName:"v-lazyloadimg",value:t.articleTopList[0].attachments[0],expression:"articleTopList[0].attachments[0]"}],staticClass:"d-block"}):e("img",{staticClass:"d-block",attrs:{src:"/images/common/top-no1.png",alt:""}})]),t.articleTopList&&t.articleTopList.length>0?e("div",{staticStyle:{width:"100%"}},[e("h2",{staticClass:"main-title mb-0 text-center"},[e("a",{staticClass:"font-weight-bold font-16 hjbox-linkline",staticStyle:{"font-family":"Microsoft YaHei"},attrs:{href:"/post/details?pid="+t.articleTopList[0].topicId}},[t._v(t._s(t._f("topNo1")(t.articleTopList[0]&&t.articleTopList[0].title)))])]),e("ul",{staticClass:"main-list mb-0"},t._l([].concat(t.articleTopList[1]||[],t.articleTopList[2]||[],t.articleTopList[3]||[],t.articleTopList[4]||[],t.articleTopList[5]||[],t.articleTopList[6]||[],t.articleTopList[7]||[],t.articleTopList[8]||[],t.articleTopList[9]||[]),(function(i,s){return e("li",{key:s},[e("p",{staticClass:"mb-0"},[e("a",{staticClass:"hjbox-linkline",attrs:{href:"/post/details?pid="+i.topicId}},[t._v(t._s(t._f("topNo2_9")(i.title)))])])])})),0)]):t._e()]):t._e(),2===t.activeIndex&&0===t.articleTopList.length?e("div",{staticClass:"container wrap-bd clearfix"},[e("div",{staticClass:"block-intro text-center",staticStyle:{width:"100%","line-height":"130px"}},[t._v("暂无数据")])]):t._e()])]),e("hj-gap",{staticStyle:{height:"16px"}}),e("div",{staticClass:"post-card"},[e("div",{staticClass:"current-fruit-title position-relative"},[e("ul",{staticClass:"tabs-list position-relative"},[e("li",{class:{active:0==t.tableTagIndex,"hjbox-linkline":0!=t.tableTagIndex},on:{click:function(e){return t.switchTable(0)}}},[e("a",[t._v("默认")])]),e("li",{class:{active:1===t.tableTagIndex,"hjbox-linkline":1!=t.tableTagIndex},on:{click:function(e){return t.switchTable(1)}}},[e("a",[t._v("最新")])]),e("li",{staticClass:"hjbox-linkline",class:{active:2===t.tableTagIndex,"hjbox-linkline":2!=t.tableTagIndex},on:{click:function(e){return t.switchTable(2)}}},[e("a",[t._v("热门")])]),e("li",{staticClass:"hjbox-linkline",class:{active:3===t.tableTagIndex,"hjbox-linkline":3!=t.tableTagIndex},on:{click:function(e){return t.switchTable(3)}}},[e("a",[t._v("精华")])]),e("li",{staticClass:"hjbox-linkline",class:{active:4===t.tableTagIndex,"hjbox-linkline":4!=t.tableTagIndex},on:{click:function(e){return t.switchTable(4)}}},[e("a",[t._v("悬赏")])]),e("li",{staticClass:"hjbox-linkline",class:{active:5===t.tableTagIndex,"hjbox-linkline":5!=t.tableTagIndex},on:{click:function(e){return t.switchTable(5)}}},[e("a",[t._v("出售")])])]),e("div",{staticClass:"handle-btn-box"},[e("ul",{staticClass:"btn-list"},[e("li",{staticClass:"input-box text-right",style:{width:"126px"}},[e("el-input",{staticClass:"text-right c-pointer article-search",staticStyle:{width:"100%","border-radius":"0"},attrs:{placeholder:"版内搜索",size:"mini"},on:{blur:t.searchKey},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[e("el-button",{attrs:{slot:"append",icon:"el-icon-search"},slot:"append"})],1)],1),e("li",[e("a",{staticClass:"btn hjbox-linkline",on:{click:function(e){return t.$router.go(0)}}},[t._v("刷新")])]),e("li",[e("a",{staticClass:"btn hjbox-linkline",attrs:{href:"javascript:void(0);"},on:{click:t.sendArticle}},[t._v("发帖")])])])])]),1===t.tableShowType?e("div",{staticClass:"type-list",staticStyle:{margin:"10px 0","padding-left":"20px"}},t._l(t.tagList||[],(function(i,s){return e("a",{key:s,staticClass:"hjbox-linkline",class:t.threeCurrent===s&&"active",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.checkMenu(i,s)}}},[t._v(t._s(i.name||"")+t._s(t.tagList.length>1?"/":""))])})),0):t._e(),2===t.tableShowType?e("div",{staticClass:"type-list",staticStyle:{margin:"10px 0","padding-left":"20px"}},[e("span",[t._v("范围：")]),e("a",{class:"topic"===t.searchPath&&"active",attrs:{href:"javascript:void(0)"},on:{click:function(e){return t.handleSearch("topic")}}},[t._v("标题")])]):t._e(),1===t.tableShowType?e("h-table",{attrs:{isLoad:t.isLoad,data:t.tableList.results||[],tableShowType:1}}):t._e(),2===t.tableShowType?e("h-table",{attrs:{data:t.keywordTableList||[],isLoad:t.isLoad,tableShowType:2,keyword:t.keyword,searchPath:t.searchPath}}):t._e()],1),e("hj-gap"),e("el-pagination",{directives:[{name:"show",rawName:"v-show",value:1===t.tableShowType,expression:"tableShowType === 1"}],staticClass:"d-flex justify-content-end",attrs:{size:"small",background:"",layout:"prev, pager, next","default-current":1,"page-size":t.tableList.page.limit,total:t.tableList.page.total},on:{"current-change":t.pageChange}}),e("hj-gap",{attrs:{height:"60"}})],1),e("div",{staticStyle:{width:"188px","margin-top":"0"},attrs:{slot:"aside"},slot:"aside"},[e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_BYSKEY}}),e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_BYXKEY}})],1)])},a=[],o=(i("5466"),i("450d"),i("ecdf")),n=i.n(o),r=(i("38a0"),i("ad41")),l=i.n(r),c=(i("14d9"),i("7e11")),d=i("fded"),h=i("0837"),u=i("1f24"),p=i("9d4b"),m=i("ba8a"),g=i("6b26"),f=function(){var t=this,e=t._self._c;return e("div",[e("table",{staticClass:"tab-bbs-list",attrs:{width:"100%",border:"0",cellspacing:"0",cellpadding:"0"}},[t._m(0),e("tbody",t._l(t.data,(function(i,s){return e("tr",{key:s},[e("td",[e("a",{staticClass:"td-title hjbox-linkline",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.openTopic(i)}}},[t._v(t._s(i.title.length<36?i.title:i.title.slice(0,36)+"...")),e("title-icon",{attrs:{topic:i}})],1)]),e("td",[e("router-link",{staticClass:"hjbox-linkcolor",attrs:{target:"_blank",to:{name:"homepage_index",params:{uid:i.user.id}}}},[t._v(t._s(i.user.nickname||""))])],1),e("td",[e("span",[t._v(t._s(t._f("newshowNumber")(i.viewCount)))])]),e("td",[e("span",[t._v(t._s(t._f("newshowNumber")(i.commentCount)))])]),e("td",[e("span",[t._v(t._s(i.lastCommentTime.slice(5,16)))])])])})),0)]),t.data&&0!==t.data.length||1!==t.tableShowType||!t.isLoad?t._e():e("div",{staticClass:"mt-3 mb-3 text-center"},[t._v("暂无该记录！")]),t.data&&0!==t.data.length||2!==t.tableShowType||!t.isLoad?t._e():e("div",{staticClass:"mt-3 mb-3 text-center"},[t._v(" 没有找到含“"+t._s(t.keyword)+"”"+t._s("topic"===t.searchPath?"标题的帖子":"的作者")+"。 ")])])},v=[function(){var t=this,e=t._self._c;return e("thead",[e("tr",[e("th",{staticStyle:{"padding-left":"10px"},attrs:{width:"406px",scope:"col"}},[t._v("标题")]),e("th",{attrs:{width:"84px",scope:"col"}},[t._v("作者")]),e("th",{attrs:{scope:"col",width:"50px"}},[t._v("点击")]),e("th",{attrs:{scope:"col",width:"45px"}},[t._v("回复")]),e("th",{attrs:{width:"75px",scope:"col"}},[t._v("回复时间")])])])}],y=function(){var t=this,e=t._self._c;return e("div",{staticClass:"title-icon",attrs:{data:t.topicType.allTop}},[t.topicType.hasPic?e("img",{attrs:{src:"/images/common/v2/image.png"}}):t._e(),t.topicType.hasVideo?e("img",{attrs:{src:"/images/common/v2/video.png"}}):t._e(),t.topicType.hasAudio?e("img",{attrs:{src:"/images/common/v2/audio.png"}}):t._e(),t.topicType.is_cream?e("img",{attrs:{src:"/images/common/v2/cream.png"}}):t._e(),t.topicType.is_top?e("img",{attrs:{src:"/images/common/v2/top.png"}}):t._e(),t.topicType.is_original?e("img",{attrs:{src:"/images/common/v2/yuan.png"}}):t._e(),1==t.topicType.type?e("img",{attrs:{src:"/images/common/v2/sale.png"}}):2==t.topicType.type?e("img",{attrs:{src:"/images/common/v2/reward.png"}}):3==t.topicType.type?e("img",{attrs:{src:"/images/common/v2/sub.png"}}):t._e(),t.topicType.allTop?e("span",{staticClass:"alltop"},[t._v("置顶")]):t._e()])},b=[],_={name:"titleicon",components:{},props:{topic:{type:Object,default:function(){return{is_cream:!1,is_top:!1,type:1}}}},data(){return{topicType:{is_original:!1,hasAudio:!1,is_cream:!1,is_top:!1,hasPic:!1,hasVideo:!1,is_hot:!1,type:0,allTop:!1}}},watch:{topic:function(t){this.updateData(t)}},created(){this.updateData(this.topic)},methods:{updateData(t){this.topicType.is_cream=t.is_cream,this.topicType.is_top=t.is_top,this.topicType.type=t.type,this.topicType.is_hot=t.is_hot,this.topicType.is_original=t.is_original,this.topicType.allTop=t.allTop,this.topicType.hasPic=t.hasPic,this.topicType.hasAudio=t.hasAudio,this.topicType.hasVideo=t.hasVideo}}},w=_,C=(i("e795"),i("2877")),x=Object(C["a"])(w,y,b,!1,null,"c82917a0",null),k=x.exports,L={name:"mytable",components:{TitleIcon:k},props:{data:{type:Array},tableShowType:{type:Number},keyword:{type:String},searchPath:{type:String},isLoad:{type:Boolean}},methods:{getimages(t){let e=0;if(t)for(let i of t){let{category:t,remoteUrl:s}=i;s&&"images"==t&&e++}return e},openTopic(t){let e=window.location.origin+"/post/details?pid="+t.topicId;window.open(e,"_blank")}}},I=L,T=(i("7f98"),Object(C["a"])(I,f,v,!1,null,null,null)),S=T.exports,$=i("d1eb"),j={data(){return{activeIndex:0,focusBool:!1,tableList:{results:[],page:{limit:20,total:0,page:1}},keywordTableList:[],tagList:[],articleTopList:[],currentPlate:{},topArticle:[],params:{page:1,nodeId:null},favorite:!1,articleDesc:"",tableTagIndex:0,keyword:"",menuList:[],threeCurrent:0,defaultPlate:!1,searchPath:"topic",tableShowType:1,rightImg:null,isLoad:!1,allTopList:[]}},mixins:[h["a"]],computed:{AD_DETAILS_BYSKEY(){return c["b"]},AD_DETAILS_BYXKEY(){return c["c"]},AD_DETAILS_BTKEY(){return c["a"]}},created(){this.isLoad=!1},async mounted(){const{nodeId:t}=this.$route.query;t&&(this.params.nodeId=Number(t)),await this.currentCollect(),await this._getPlateInfo(),await this.getAllTop(),await this._getTableList()},beforeRouteUpdate(t,e,i){this.tagList.length>0&&(this.tagList=[]),this.isLoad=!1,this.tableList={results:[],page:{limit:20,total:0,page:1}},this.params={page:1,nodeId:null},i()},methods:{async getAllTop(){let t=await Object(u["d"])();t.data&&t.data.length>0&&(t.data.forEach(t=>{t.allTop=!0}),this.allTopList=t.data)},handleSearch(t){this.searchPath=t,this.searchKey()},routerData(t){this.menuList=t,this._initParams(this.$route.query.nodeId)},tableRowClassName({row:t,rowIndex:e}){if(e%2!==0)return"even-row"},_notS(t){this.activeIndex=t},_initParams(t){const{indexS:e,parent:i,children:s}=Object($["b"])(this.menuList,t);this.tagList=[],e&&1===e.length?this.tagList.push({name:"全部",nodeId:i.nodeId}):e&&2===e.length&&(this.tagList.push({name:"全部",nodeId:s.nodeId}),Array.isArray(s.children)&&s.children.length>0&&s.children.forEach(t=>this.tagList.push(t))),this.currentPlate=s},async _getPlateInfo(){try{const t=await Object(u["e"])({nodeId:this.params.nodeId});this.articleDesc=t.data}catch(t){this.$message.error(t)}},async _getTableList(){this.isLoad=!1;try{const t=await Object(u["f"])(Object.assign(this.params,{type:this.tableTagIndex,limit:50}));if(1===this.params.page){let e=[];Array.isArray(t.data.results)&&t.data.results.length>0&&t.data.results.forEach(t=>{t.is_top&&e.push(t)}),this.defaultPlate||(this.defaultPlate=!0,this.articleTopList=e.slice(0,9))}t.data.results&&t.data.results.length>0?t.data.results=this.allTopList.concat(t.data.results):t.data.results=this.allTopList,this.tableList=t.data||m["b"],this.$nextTick(()=>{this.isLoad=!0})}catch(t){this.$message.error(t)}},async currentCollect(){try{const t=await Object(u["i"])({entityId:this.params.nodeId,entityType:"node"});this.favorite=t.data.favorite||!1}catch(t){}},async switchTable(t){this.tableTagIndex=t,this.tableList=m["b"],this.params.page=1,this._getTableList()},async searchKey(){if(""===this.keyword)return this.tableShowType=1,void(this.keywordTableList=[]);this.tableShowType=2,this.isLoad=!1;try{this.focusBool=!this.focusBool;const{nodeId:t}=this.$route.query,e=await p["u"].call(this,this.searchPath,{node_id:t,key:this.keyword});this.keywordTableList=e.data.results,this.isLoad=!0}catch(t){this.$message.error(t)}},pageChange(t,e){this.params.page=t,this._getTableList()},checkMenu(t,e){this.params.page=1,this.threeCurrent=e,this.params.nodeId=t.nodeId,this._getTableList()},async addFavorite(){if(g["a"].isLogon())try{await Object(u["a"])({entityId:this.params.nodeId,entityType:"node"});this.favorite=!this.favorite}catch(t){this.$message.error(t)}else this.$loginWindow({reload:!0})},async deleteFavorite(){if(g["a"].isLogon())try{await Object(u["c"])({entityId:this.params.nodeId,entityType:"node"});this.favorite=!this.favorite}catch(t){this.$message.error(t)}else this.$loginWindow()},sendArticle(){g["a"].isLogon()?this.$router.push({path:"/addArticle",query:this.$route.query}):this.$loginWindow()}},filters:{topNo1(t){return t?t.length>24?t.substr(0,23)+"...":t:""},topNo2_9(t){return t?t.length>12?t.substr(0,12)+"...":t:""}},watch:{async $route(){this.tableList=m["b"],this.keywordTableList=[],this.currentPlate={},this.topArticle=[],this.articleTopList=[],this.params={page:1,nodeId:null};const{nodeId:t}=this.$route.query;t&&(this.params.nodeId=Number(t),this.threeCurrent=0),this.defaultPlate=!1,this.articleTopList=[],await this.currentCollect(),await this._getPlateInfo(),await this._getTableList(),this._initParams(this.$route.query.nodeId)}},components:{BaseHeaderLayout:d["a"],ElTable:l.a,ElTableColumn:n.a,HTable:S}},O=j,N=(i("5c0e"),Object(C["a"])(O,s,a,!1,null,null,null));e["default"]=N.exports},"23aa":function(t,e,i){},2848:function(t,e,i){"use strict";i("97c3")},3466:function(t,e,i){},3753:function(t,e,i){"use strict";i("813e")},"3f11":function(t,e,i){},"3fbe":function(t,e,i){"use strict";i("7730")},4379:function(t,e,i){},4733:function(t,e,i){"use strict";function s(t,e){if(null==t||null==e)return null;var i,s,a,o;try{a=t.toString().split(".")[1].length}catch(n){a=0}try{o=e.toString().split(".")[1].length}catch(n){o=0}return i=Number(t.toString().replace(".","")),s=Number(e.toString().replace(".","")),i*s/Math.pow(10,a+o)}function a(t,e){var i,s,a=t.toString(),o=e.toString(),n=arguments[2];return i=(o.split(".")[1]?o.split(".")[1].length:0)-(a.split(".")[1]?a.split(".")[1].length:0),s=Number(a.replace(".",""))/Number(o.replace(".",""))*Math.pow(10,i),Number("number"!==typeof n?s:s.toFixed(parseInt(n)))}i.d(e,"b",(function(){return s})),i.d(e,"a",(function(){return a}))},"4c4e":function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("base-header-layout",{on:{routerData:t.routerData}},[e("div",{staticClass:"addArtice",staticStyle:{"margin-top":"15px"}},[e("el-form",{staticStyle:{padding:"0 20px"},attrs:{rules:t.rules,model:t.form,"status-icon":"","label-width":"80px"},on:{submit:t.handleSubmit}},[e("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"板块："}},[t.selectList1.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},on:{change:t.handlerSelectType1},model:{value:t.selectType1,callback:function(e){t.selectType1=e},expression:"selectType1"}},t._l(t.selectList1,(function(i,s){return e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))])])})),1):t._e(),t.selectList2.length>0?e("span",{staticStyle:{margin:"0 10px"}},[t._v(">")]):t._e(),t.selectList2.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},on:{change:t.handlerSelectType2},model:{value:t.selectType2,callback:function(e){t.selectType2=e},expression:"selectType2"}},t._l(t.selectList2,(function(i,s){return e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))]),i.vipLimit?e("span",{staticClass:"vipicon"},[1==i.vipLimit?e("img",{attrs:{src:"/images/common/vip12x.png",alt:""}}):2==i.vipLimit?e("img",{attrs:{src:"/images/common/vip22x.png",alt:""}}):3==i.vipLimit?e("img",{attrs:{src:"/images/common/vip32x.png",alt:""}}):4==i.vipLimit?e("img",{attrs:{src:"/images/common/vip42x.png",alt:""}}):t._e()]):t._e()])})),1):t._e(),t.selectList3.length>0?e("span",{staticStyle:{margin:"0 10px"}},[t._v(">")]):t._e(),t.selectList3.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},model:{value:t.selectType3,callback:function(e){t.selectType3=e},expression:"selectType3"}},t._l(t.selectList3,(function(i,s){return e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))]),i.vipLimit?e("span",{staticClass:"vipicon"},[1==i.vipLimit?e("img",{attrs:{src:"/images/common/vip12x.png",alt:""}}):2==i.vipLimit?e("img",{attrs:{src:"/images/common/vip22x.png",alt:""}}):3==i.vipLimit?e("img",{attrs:{src:"/images/common/vip32x.png",alt:""}}):4==i.vipLimit?e("img",{attrs:{src:"/images/common/vip42x.png",alt:""}}):t._e()]):t._e()])})),1):t._e()],1),e("el-form-item",{attrs:{label:"标签：",prop:""}},[e("div",{staticClass:"tags-box position-relative",on:{click:t.visibleTags}},[t._v(" "+t._s(t.tagText)+" "),e("i",{staticClass:"el-icon-circle-plus-outline position-absolute circle",attrs:{slot:"suffix"},slot:"suffix"})])]),e("el-form-item",{attrs:{label:"标题：",prop:"title"}},[e("el-input",{attrs:{size:"mini",maxlength:"36",data:t.articleInfo},model:{value:t.crateArticleQuest.title,callback:function(e){t.$set(t.crateArticleQuest,"title",e)},expression:"crateArticleQuest.title"}})],1),e("el-form-item",{attrs:{label:"内容：",prop:"content"}},[e("Editor",{ref:"editor",attrs:{editorType:"update"}})],1)],1),e("div",{staticClass:"d-flex justify-content-between align-items-center",staticStyle:{"margin-right":"34px","padding-left":"70px"}},[e("span",{staticStyle:{"font-size":"12px",color:"#ff6565"}},[t._v("注意：悬赏贴悬赏时长为72-240整数")]),e("div",[e("button",{staticClass:"save-btn",on:{click:function(e){return t.sendArticle("drafts")}}},[t._v(" 保存草稿 ")]),e("button",{staticClass:"save-btn",on:{click:t.goback}},[t._v("取消")]),e("button",{staticClass:"common-submitBtn",on:{click:t.sendArticle}},[t._v("发帖")])])])],1),e("hj-gap",{attrs:{height:"60"}}),e("HjDiyModal",{attrs:{visible:t.visible}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"position-absolute tabs-modal"},[e("div",{staticClass:"title position-relative"},[e("p",[t._v("常用标签")]),e("i",{staticClass:"el-icon-close position-absolute",staticStyle:{top:"15px",right:"15px","z-index":"88"},on:{click:function(e){t.visible=!1}}})]),e("div",{staticClass:"content"},[e("div",{staticClass:"search"}),e("div",{staticClass:"d-flex justify-content-between"},[e("el-input",{staticStyle:{width:"269px"},attrs:{placeholder:"请输入要搜索的标签"},on:{change:t.searchKeyword},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.searchKeyword}},[t._v("搜索")])],1),e("div",{staticClass:"tab-list mt-2 mb-2"},[t._l(t.tagsCopyList.results,(function(i,s){return e("el-tag",{key:s,staticClass:"t mb-1 c-pointer",attrs:{type:"",effect:t.tagCheckList.some(t=>t.tagName===i.tagName)?"dark":"plain"},on:{click:function(e){return t.changeTag(i,s)}}},[t._v("#"+t._s(i.tagName||"")+" ")])})),t.tagsCopyList.results&&0!==t.tagsCopyList.results.length?t._e():e("p",{staticClass:"text-center",staticStyle:{"font-size":"12px",color:"#b8b8b8","margin-top":"50px"}},[t._v(" 没有搜索到该标签哟~ ")])],2),e("div",{staticClass:"action d-flex justify-content-end"},[e("el-button",{staticClass:"mr-2",on:{click:t.turnTags}},[t._v("换一换")]),e("el-button",{attrs:{type:"primary"},on:{click:t.OkTags}},[t._v("确定")])],1)])])])],1)},a=[],o=(i("0fb7"),i("450d"),i("f529")),n=i.n(o),r=(i("14d9"),i("fded")),l=i("095c"),c=i("1f24"),d=i("ba8a"),h=i("81b0"),u=i("29ad"),p=i("d1eb"),m=i("dafe"),g=i("2f62"),f={data(){return{articleInfo:{}}},created(){this._initGetArticle()},methods:{...Object(g["d"])({updateVideoData:"updateVideoData"}),_processVideo(){try{const t=document.querySelectorAll("video");for(let e=0;e<t.length;e++){if(""!==t[e].id)continue;if(-1!=t[e].getAttribute("src").indexOf(".mp4")){this.$message.error("视频格式错误请联系管理员");continue}let i=t[e].getAttribute("class");i&&-1!==i.indexOf("video-js vjs-default-skin vjs-big-play-centered")||(t[e].className+=" video-js vjs-default-skin vjs-big-play-centered"),t[e].id="myVideo_"+e+1;let s=videojs(t[e].id,{bigPlayButton:!0,textTrackDisplay:!1,posterImage:!1,errorDisplay:!1,hls:{withCredentials:!0},controlBar:{fullscreenToggle:!1}});s.src({src:t[e].src,type:"application/x-mpegURL"})}}catch(t){}},async _initGetArticle(){try{const{topic_id:t,topic_pending_id:e,source:i=1}=this.$route.query,s=await Object(c["k"])({topic_id:t,pending_id:e,source:i});console.log("--e-e-response.data.attachments-e-e--",s.data.attachments),s.data.liteContent=Object(m["c"])(s.data&&s.data.attachments,s.data.liteContent),this.articleInfo=s.data||{},this.crateArticleQuest.title=this.articleInfo.title||"",this.articleInfo.liteContent=Object(u["a"])(this.articleInfo.liteContent),this._initMenu(),this.$nextTick(()=>{0==e&&this._processVideo()}),this.$refs.editor._setUpdateParams(this.articleInfo),this.tagCheckList=this.articleInfo.tags||[],this.tagCheckList.length>0&&(this.tagText=this.tagCheckList.map(t=>"#"+t.tagName).join(" ")),this.articleInfo.attachments&&this.articleInfo.attachments.length>0&&this.articleInfo.attachments.forEach(t=>{"video"===t.category&&this.$nextTick(()=>{var e=this;let i=document.querySelector('[data-id="'+t.id+'"]');i.onclick=function(){e.updateVideoData({show:!0,url:t.remoteUrl,id:t.id,name:t.name?t.name:"视频_"+t.id})}});let e=t.remoteUrl.toLowerCase();-1==e.indexOf(".hj")&&-1==e.indexOf(".jpg.txt")&&-1==e.indexOf(".jpeg.txt")&&-1==e.indexOf(".png.txt")&&-1==e.indexOf(".gif.txt")||this.$nextTick(()=>{let e=document.querySelector('[data-id="'+t.id+'"]');e&&"VIDEO"!=e.nodeName&&(e.src="/images/common/project/loading.gif"),Object(m["a"])(t.remoteUrl,t.id,t=>{e&&(e.src=t)})})})}catch(t){if("无权限"==t)return void(window.location.href="/");this.$message.error(t.toString())}},async visibleTags(){try{const e=await Object(c["g"])({page:this.tagPage});this.tagsList=e.data||d["d"];let i="";try{i=JSON.stringify(e.data)}catch(t){i=JSON.stringify(d["d"])}this.tagsCopyList=JSON.parse(i),this.visible=!this.visible}catch(t){this.$message.error(t)}}}},v={name:"add",data(){return{formLayout:"horizontal",selectType:"",textareaValue:"",radio:3,input:"",extraVisible:!1,visible:!1,form:{},keyword:"",oneIndex:"",twoIndex:"",selectList1:[],selectList2:[],selectList3:[],selectType1:"",selectType2:"",selectType3:"",rules:{title:[{required:!0,message:"请输入标题",trigger:"blur"}],content:[{required:!0,message:"请输入内容",trigger:"blur"}]},tagText:"",tagPage:1,tagsList:d["d"],tagsCopyList:d["d"],tagCheckList:[],crateArticleQuest:{title:""}}},mixins:[f],created(){document.getElementById("body").classList.remove("filter-bg"),document.getElementById("body").classList.add("bg-color"),console.log("----e-这里是编辑页面-e-e--")},computed:{showprompt(){const t=this.selectList2,e=this.selectType2;if(t.length&&""!=e){let i={};for(let s of t)if(s.nodeId==e){i=s;break}if(i.hasOwnProperty("vipLimit")&&i.vipLimit>this.userInfo.vip)return[1,i]}return[0]}},methods:{routerData(){this._initMenu()},handlerSelectType1(){this.selectType2="",this.selectType3="";for(let t=0;t<this.selectList1.length;t++){const e=this.selectList1[t];if(e.nodeId===this.selectType1){this.selectList2=e.children;break}}},handlerSelectType2(){this.selectType3="";let t=!1;for(let e=0;e<this.selectList2.length;e++){const i=this.selectList2[e];if(i.nodeId===this.selectType2){Array.isArray(i.children)&&i.children&&(this.selectList3=i.children),t=!0;break}}t||(this.selectList3=[])},goback(){this.$router.back()},navigatorTo(){n.a.warning("功能待开发")},remove(){this.$refs.editor.clear(),this.tagsList=[],this.crateArticleQuest.title="",this.tagCheckList=[],this.tagsList=d["d"],this.tagsCopyList=d["d"],this.tagText="",this.tagPage=1},async sendArticle(t){const{nodeId:e,topic_id:i=0,topic_pending_id:s=0}=this.$route.query;try{let e=this.$refs.editor.content,a=e.split('<img src="');a.forEach(t=>{if(-1!=t.indexOf("data:image/")){let i=t.split('"')[0],s=1024e3,a=Math.ceil(i.length/10240);for(let t=0;t<a;t++){let a=i.slice(t*s,(t+1)*s);a&&(e=e.replace(a,""))}}}),e=Object(u["c"])(e);let o=document.querySelectorAll(".ql-editor #showaudio");o&&o.length>0&&o.forEach((function(t){let i=t.getAttribute("data-id"),s=t.getAttribute("src");e=e.replace(`<audio src="${s}" controls="true" controlslist="nodownload" id="showaudio" data-id="${i}"></audio>`,`<audio src="haijiao.com" controls="true" controlslist="nodownload" id="showaudio" data-id="${i}"></audio>`)})),this.articleInfo.attachments&&this.articleInfo.attachments.length>0&&this.articleInfo.attachments.forEach(t=>{"video"==t.category&&(e=Object(m["b"])(e))}),this.$refs.editor.fileList&&this.$refs.editor.fileList.length>0&&this.$refs.editor.fileList.forEach(t=>{t.isImage||(e=e.replace(/<div id="myVideo_(\s|\S)*<p class="vjs-control-text">End of dialog window.<\/p><\/div><\/div>/g,`<video src="${t.remoteUrl}" data-id="${t.id}" style="width:100%;height:500px;"></video>`))});let r=[],l=this.$refs.editor.sendFriendList;for(let t=0;t<l.length;t++)r.push(1*l[t].userId),e=e.replace(new RegExp("@"+l[t].nickname),`<span data-uid="${l[t].userId}"  class="at-box">@${l[t].nickname} </span>`);let h=null;if(h=""!==this.selectType3?this.selectType3:""!==this.selectType2?this.selectType2:""!==this.selectType1?this.selectType1:Number(this.crateArticleQuest.node.nodeId),"drafts"==t){const t=await Object(c["z"])({source:Number(this.$route.query.source)||1,topic_node_id:h,title:this.crateArticleQuest.title,content:e,tags:this.tagCheckList.map(t=>t.tagName),topic_id:Number(i),topic_pending_id:Number(s),ats:r,isPublisher:!1});return void(t.data?(n.a.success("保存成功"),window.location.href="/post/details?pid="+t.data):n.a.success("保存成功"))}const p=await Object(c["z"])({source:Number(this.$route.query.source)||1,title:this.crateArticleQuest.title,content:e,tags:this.tagCheckList.map(t=>t.tagName),topic_id:Number(i),topic_pending_id:Number(s),ats:r,isPublisher:!0,topic_node_id:h});p.data?(n.a.success("发帖成功！"),window.location.href="/post/details?pid="+p.data):(n.a.success("发布成功，待审核通过后便可查看。"),this.$router.push({path:"/addArticle"})),this.$refs.editor.clear(),this.tagsList=[],this.crateArticleQuest.title="",this.crateArticleQuest.content="",this.tagCheckList=[],this.tagsList=d["d"],this.tagsCopyList=d["d"],this.tagText="",this.tagPage=1}catch(a){n.a.error(a)}},searchKeyword:Object(h["debounce"])((function(){let t="";try{t=JSON.stringify(this.tagsList)}catch(e){t=JSON.stringify(d["d"])}this.tagsCopyList=JSON.parse(t),""!==this.keyword&&(this.tagsCopyList.results=this.tagsCopyList.results.filter(t=>{if(-1!==t.tagName.indexOf(this.keyword))return t}))}),200),changeTag(t,e){let i=this.tagCheckList.some(e=>{if(e.tagName===t.tagName)return!0});if(i){for(var s=0;s<this.tagCheckList.length;s++)if(this.tagCheckList[s].tagName===t.tagName){this.tagCheckList.splice(s,1);break}this.tagText=this.tagCheckList.map(t=>"#"+t.tagName).join(" ")}else this.tagCheckList.push(t),this.tagText=this.tagCheckList.map(t=>"#"+t.tagName).join(" ")},closeTag(){this.visible=!1,this.tagPage=1},async turnTags(){let t=Math.ceil(this.tagsList.page.total/this.tagsList.page.limit);if(this.tagPage<t){this.tagPage+=1;try{const t=await Object(c["g"])({page:this.tagPage});this.tagsList=t.data||d["d"];let i="";try{i=JSON.stringify(t.data)}catch(e){i=JSON.stringify(d["d"])}this.tagsCopyList=JSON.parse(i)}catch(e){this.$message.error(e)}}else{this.tagPage=1;try{const t=await Object(c["g"])({page:this.tagPage});this.tagsList=t.data||d["d"];let i="";try{i=JSON.stringify(t.data)}catch(e){i=JSON.stringify(d["d"])}this.tagsCopyList=JSON.parse(i)}catch(e){this.$message.error(e)}}},OkTags(){this.visible=!1},async visibleTags(){try{const e=await Object(c["g"])({page:this.tagPage});this.tagsList=e.data||d["d"];let i="";try{i=JSON.stringify(e.data)}catch(t){i=JSON.stringify(d["d"])}this.tagsCopyList=JSON.parse(i),this.visible=!this.visible}catch(t){this.$message.error(t)}},visibleAction(){this.extraVisible=!0},async _initMenu(){const t=this.$store.state.routerMenu;var e=0;this.articleInfo.node&&(e=this.articleInfo.node.nodeId);let i=0;if(e)i=e;else{if(!t.length)return!1;t[0].children&&t[0].children[0]&&(i=t[0].children[0].nodeId)}const{indexS:s,parent:a}=Object(p["b"])(t,i);if(a&&s)try{if(this.selectList1=t,a&&(a.parentId?this.selectType1=a.parentId:this.selectType1=a.nodeId),2===s.length&&Array.isArray(a.children)){const[t,e]=s;this.selectList2=a.children,this.selectType2=a.children[e].nodeId,this.selectList3=a.children[e].children||[]}else if(3===s.length&&Array.isArray(a.children)){const[t,e,i]=s;this.selectList2=this.selectList1[e].children,this.selectList1.forEach(t=>{t.nodeId==a.parentId&&(this.selectList2=t.children||[])}),this.selectType2=a.nodeId,this.selectList3=a.children,this.selectType3=a.children[i].nodeId}}catch(o){this.$message.error(o.toString())}},handleSubmit(t){t.preventDefault(),this.form.validateFields((t,e)=>{})},handleSelectChange(t){this.form.setFieldsValue({note:`Hi, ${"male"===t?"man":"lady"}!`})}},components:{BaseHeaderLayout:r["a"],Editor:l["a"]}},y=v,b=(i("0478"),i("2877")),_=Object(b["a"])(y,s,a,!1,null,null,null);e["default"]=_.exports},"593c":function(t,e,i){},"5c0e":function(t,e,i){"use strict";i("4379")},"5de4":function(t,e,i){},"69ae":function(t,e,i){"use strict";i("593c")},"6dec":function(t,e,i){"use strict";i("74f8")},"74f8":function(t,e,i){},7730:function(t,e,i){},78396:function(t,e,i){"use strict";i("c1e9")},"7f98":function(t,e,i){"use strict";i("07d8")},"813e":function(t,e,i){},"877b":function(t,e,i){},9709:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("router-view")},a=[],o=i("2877"),n={},r=Object(o["a"])(n,s,a,!1,null,null,null);e["default"]=r.exports},"97c3":function(t,e,i){},"9c3b":function(t,e,i){"use strict";i("5de4")},"9f1d":function(t,e,i){"use strict";i("c06a")},"9f96":function(t,e,i){},a478:function(t,e,i){},a7ac:function(t,e,i){"use strict";i("23aa")},a91c:function(t,e,i){"use strict";i.r(e);var s=function(){var t=this,e=t._self._c;return e("base-header-layout",{on:{routerData:t.routerData}},[e("div",{staticClass:"addArtice",staticStyle:{"margin-top":"15px"}},[e("el-form",{ref:"article",staticStyle:{"margin-right":"32px"},attrs:{model:t.crateArticleQuest,rules:t.rules,"label-width":"80px"}},[e("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"板块："}},[t.selectList1.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},on:{change:t.handlerSelectType1},model:{value:t.selectType1,callback:function(e){t.selectType1=e},expression:"selectType1"}},t._l(t.selectList1,(function(i,s){return e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))])])})),1):t._e(),t.selectList2.length>0?e("span",{staticStyle:{margin:"0 10px"}},[t._v(">")]):t._e(),t.selectList2.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},on:{change:t.handlerSelectType2},model:{value:t.selectType2,callback:function(e){t.selectType2=e},expression:"selectType2"}},t._l(t.selectList2,(function(i,s){return"橘子直播"!=i.name&&"草榴社区"!=i.name?e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))]),i.vipLimit?e("span",{staticClass:"vipicon"},[1==i.vipLimit?e("img",{attrs:{src:"/images/common/vip12x.png",alt:""}}):2==i.vipLimit?e("img",{attrs:{src:"/images/common/vip22x.png",alt:""}}):3==i.vipLimit?e("img",{attrs:{src:"/images/common/vip32x.png",alt:""}}):4==i.vipLimit?e("img",{attrs:{src:"/images/common/vip42x.png",alt:""}}):t._e()]):t._e()]):t._e()})),1):t._e(),t.selectList3.length>0?e("span",{staticStyle:{margin:"0 10px"}},[t._v(">")]):t._e(),t.selectList3.length>0?e("el-select",{staticStyle:{width:"103px"},attrs:{size:"mini"},model:{value:t.selectType3,callback:function(e){t.selectType3=e},expression:"selectType3"}},t._l(t.selectList3,(function(i,s){return e("el-option",{key:s,attrs:{label:i.name,value:i.nodeId}},[e("span",[t._v(t._s(i.name))]),i.vipLimit?e("span",{staticClass:"vipicon"},[1==i.vipLimit?e("img",{attrs:{src:"/images/common/vip12x.png",alt:""}}):2==i.vipLimit?e("img",{attrs:{src:"/images/common/vip22x.png",alt:""}}):3==i.vipLimit?e("img",{attrs:{src:"/images/common/vip32x.png",alt:""}}):4==i.vipLimit?e("img",{attrs:{src:"/images/common/vip42x.png",alt:""}}):t._e()]):t._e()])})),1):t._e(),t.showprompt[0]?e("div",{staticStyle:{"font-size":"12px",float:"right",color:"rgb(255, 101, 101)"}},[t._v(" 抱歉,"+t._s(t.showprompt[1].name||"")+"该板块至少需要VIP"+t._s(t.showprompt[1].vipLimit)+" ")]):t._e()],1),e("el-form-item",{staticStyle:{"margin-bottom":"10px"},attrs:{label:"标签："}},[e("div",{staticClass:"tags-box position-relative",on:{click:t.visibleTags}},[t._v(" "+t._s(t.tagText)+" "),e("i",{staticClass:"el-icon-circle-plus-outline position-absolute circle",attrs:{slot:"suffix"},slot:"suffix"})])]),e("el-form-item",{attrs:{label:"标题：",prop:"title"}},[e("el-input",{attrs:{size:"mini",maxlength:"36"},model:{value:t.crateArticleQuest.title,callback:function(e){t.$set(t.crateArticleQuest,"title",e)},expression:"crateArticleQuest.title"}})],1),e("el-form-item",{attrs:{label:"内容：",prop:"content"}},[e("Editor",{ref:"editor",attrs:{viplevel:t.userInfo.vip,querySaleTopicStatus:t.querySaleTopicStatus},on:{upgradeVip:t.showUpgradeVip}})],1)],1),e("div",{staticClass:"d-flex justify-content-between align-items-center",staticStyle:{"margin-right":"34px","padding-left":"70px"}},[e("span",{staticStyle:{"font-size":"12px",color:"#ff6565"}},[t._v("注意：悬赏贴悬赏时长为72-240整数")]),e("div",[e("button",{staticClass:"save-btn",on:{click:function(e){return t.sendArticle("drafts")}}},[t._v("保存草稿")]),e("button",{staticClass:"save-btn",on:{click:t.remove}},[t._v("清空")]),e("button",{staticClass:"common-submitBtn",on:{click:t.sendArticle}},[t._v("发帖")])])])],1),e("hj-gap",{attrs:{height:"60"}}),e("HjDiyModal",{attrs:{visible:t.visible}},[e("div",{directives:[{name:"show",rawName:"v-show",value:t.visible,expression:"visible"}],staticClass:"position-absolute tabs-modal"},[e("div",{staticClass:"title position-relative"},[e("p",[t._v("常用标签")]),e("i",{staticClass:"el-icon-close position-absolute",staticStyle:{top:"15px",right:"15px","z-index":"88"},on:{click:function(e){t.visible=!1}}})]),e("div",{staticClass:"content"},[e("div",{staticClass:"search"}),e("div",{staticClass:"d-flex justify-content-between"},[e("el-input",{staticStyle:{width:"269px"},attrs:{placeholder:"请输入要搜索的标签"},on:{change:t.searchKeyword},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}}),e("el-button",{attrs:{type:"primary",size:"mini"},on:{click:t.searchKeyword}},[t._v("搜索")])],1),e("div",{staticClass:"tab-list mt-2 mb-2"},[t._l(t.tagsCopyList.results,(function(i,s){return e("el-tag",{key:s,ref:"saveTagInput",refInFor:!0,staticClass:"t mb-1 c-pointer",attrs:{type:"",effect:t.tagCheckList.some(t=>t.tagName===i.tagName)?"dark":"plain"},on:{click:function(e){return t.changeTag(i,s)}}},[t._v("#"+t._s(i.tagName||"")+" ")])})),t.inputVisible?e("el-input",{ref:"saveTagInput",staticClass:"input-new-tag",attrs:{maxlength:"10",size:"small"},on:{blur:t.handleInputConfirm},nativeOn:{keyup:function(e){return!e.type.indexOf("key")&&t._k(e.keyCode,"enter",13,e.key,"Enter")?null:t.handleInputConfirm.apply(null,arguments)}},model:{value:t.inputValue,callback:function(e){t.inputValue=e},expression:"inputValue"}}):e("el-button",{staticClass:"button-new-tag",staticStyle:{margin:"0 5px"},attrs:{size:"small"},on:{click:t.showInput}},[t._v("+ 添加自定义")]),t.tagsCopyList.results&&0!==t.tagsCopyList.results.length?t._e():e("p",{staticClass:"text-center",staticStyle:{"font-size":"12px",color:"#b8b8b8","margin-top":"50px"}},[t._v(" 没有搜索到该标签哟~ ")])],2),e("div",{staticClass:"action d-flex justify-content-end"},[e("el-button",{staticClass:"mr-2",on:{click:t.turnTags}},[t._v("换一换")]),e("el-button",{attrs:{type:"primary"},on:{click:t.OkTags}},[t._v("确定")])],1)])])])],1)},a=[],o=(i("0fb7"),i("450d"),i("f529")),n=i.n(o),r=(i("14d9"),i("6b26"),i("2f62")),l=i("fded"),c=i("095c"),d=i("1f24"),h=i("ba8a"),u=i("81b0"),p=i("d1eb"),m=i("29ad"),g=i("dafe"),f={computed:{...Object(r["c"])({userInfo:"userInfo"}),showprompt(){const t=this.selectList2,e=this.selectType2;if(t.length&&""!=e){let i={};for(let s of t)if(s.nodeId==e){i=s;break}if(i.hasOwnProperty("vipLimit")&&i.vipLimit>this.userInfo.vip)return[1,i]}return[0]}},data(){return{rules:{title:[{required:!0,message:"标题不能为空",trigger:"blur"}],content:[{required:!0,message:"内容不能为空",trigger:"blur"}]},formLayout:"horizontal",selectType:"",textareaValue:"",radio:3,input:"",extraVisible:!1,visible:!1,keyword:"",oneIndex:"",twoIndex:"",selectList1:[],selectList2:[],selectList3:[],selectType1:"",selectType2:"",selectType3:"",tagText:"",tagPage:1,tagsList:h["d"],tagsCopyList:h["d"],tagCheckList:[],crateArticleQuest:{title:"",content:""},menuList:[],inputVisible:!1,inputValue:"",querySaleTopicStatus:{publishDiamondSaleTopic:!1,publishGoldSaleTopic:!1}}},beforeRouteLeave(t,e,i){console.log(t,e),"addArticle"===t.name?i():this.crateArticleQuest.title&&this.$store.state.isLogin||this.$store.state.isLogin&&this.$refs.editor.request().content?this.$hjConfirm("还没有发布成功，如果现在离开当前页面，可能会丢失所有未保存的内容，是否确认离开？",{async onOk(){i()}}):i()},created(){document.getElementById("body").classList.remove("filter-bg"),document.getElementById("body").classList.add("bg-color"),this.getQuerySaleTopicStatus(),this.menuList=this.$store.state.routerMenu,this._initMenu()},methods:{...Object(r["d"])(["updateLevelUpgrade"]),async getQuerySaleTopicStatus(){try{const t=await Object(d["u"])();this.querySaleTopicStatus=t.data}catch(t){}},showUpgradeVip(){this.updateLevelUpgrade(1)},showInput(){this.inputVisible=!0,this.$nextTick(t=>{this.$refs.saveTagInput.$refs.input.focus()})},handleInputConfirm(){let t=this.inputValue;this.tagsCopyList.results||(this.tagsCopyList.results=[],this.tagsList.results=[]),t&&(this.tagsCopyList.results.push({tagId:this.tagsCopyList.results.length,tagName:t}),this.tagsList.results.push({tagId:this.tagsCopyList.results.length,tagName:t})),this.inputVisible=!1,this.inputValue=""},async _initMenu(){const t=this.menuList,{nodeId:e}=this.$route.query;let i=0;if(e)i=e;else{if(!t.length)return!1;i=t[0].children[0].nodeId}const{indexS:s,parent:a}=Object(p["b"])(t,i);try{if(this.selectList1=t,a&&(a.parentId?this.selectType1=a.parentId:this.selectType1=a.nodeId),2===s.length&&Array.isArray(a.children)){const[t,e]=s;this.selectList2=a.children,this.selectType2=a.children[e].nodeId,this.selectList3=a.children[e].children||[]}else if(3===s.length&&Array.isArray(a.children)){const[t,e,i]=s;this.selectList2=this.selectList1[e].children,this.selectList1.forEach(t=>{t.nodeId==a.parentId&&(this.selectList2=t.children||[])}),this.selectType2=a.nodeId,this.selectList3=a.children,this.selectType3=a.children[i].nodeId}}catch(o){this.$message.error(o.toString())}},routerData(t){this.menuList=this.$store.state.routerMenu,this._initMenu()},handlerSelectType1(){this.selectType2="",this.selectType3="";for(let t=0;t<this.selectList1.length;t++){const e=this.selectList1[t];if(e.nodeId===this.selectType1){this.selectList2=e.children;break}}},handlerSelectType2(){this.selectType3="";let t=!1;for(let e=0;e<this.selectList2.length;e++){const i=this.selectList2[e];if(i.nodeId===this.selectType2){Array.isArray(i.children)&&i.children&&(this.selectList3=i.children),t=!0;break}}t||(this.selectList3=[])},navigatorTo(){this.warning("功能待开发")},remove(){this.$refs.editor.clear(),this.tagsList=[],this.crateArticleQuest.title="",this.tagCheckList=[],this.tagsList=h["d"],this.tagsCopyList=h["d"],this.tagText="",this.tagPage=1},async sendArticle(t){const e=this.$refs.editor.request(),i=this.showprompt;if(i[0])return this.showUpgradeVip(),!1;if(1==e.type){if(0==e.money_type)return this.$message.warning("请选择货币类型"),!1;if(this.$refs.editor&&!this.$refs.editor.private_issell())return this.showUpgradeVip(),!1}this.crateArticleQuest.content=e.content,this.$refs.article.validate(async e=>{if(e){let e=null;e=""!==this.selectType3?this.selectType3:""!==this.selectType2?this.selectType2:""!==this.selectType1?this.selectType1:Number(this.$route.query.nodeId);let a=this.crateArticleQuest.content;a=Object(m["c"])(a);let o=document.querySelectorAll(".ql-editor #showaudio");o&&o.length>0&&o.forEach((function(t){let e=t.getAttribute("data-id"),i=t.getAttribute("src");a=a.replace(`<audio src="${i}" controls="true" controlslist="nodownload" id="showaudio" data-id="${e}"></audio>`,`<audio src="haijiao.com" controls="true" controlslist="nodownload" id="showaudio" data-id="${e}"></audio>`)}));let r=a.split('<img src="');r.forEach(t=>{if(-1!=t.indexOf("data:image/")){let e=t.split('"')[0],i=1024e3,s=Math.ceil(e.length/10240);for(let t=0;t<s;t++){let s=e.slice(t*i,(t+1)*i);s&&(a=a.replace(s,""))}}}),a=Object(g["b"])(a);let l=this.$refs.editor.sendFriendList;for(let t=0;t<l.length;t++)a=a.replace(new RegExp("@"+l[t].nickname),`<span data-uid="${l[t].userId}"  class="at-box">@${l[t].nickname} </span>`);if("drafts"==t){try{const t=await Object(d["v"])(Object.assign(this.$refs.editor.request(),{title:this.crateArticleQuest.title,content:a,node_id:e,tags:this.tagCheckList.map(t=>t.tagName),isPublisher:!1}));t.success&&(this.$message.success("保存成功！"),this.tagsList=[],this.crateArticleQuest.title="",this.tagCheckList=[],this.tagsList=h["d"],this.tagsCopyList=h["d"],this.tagText="",this.tagPage=1,this.$refs.editor.clear())}catch(s){i.close(),this.$message.error(s.toString())}return}var i=n.a.warning({message:"正在发送请稍后...",duration:0});try{const t=await Object(d["v"])(Object.assign(this.$refs.editor.request(),{title:this.crateArticleQuest.title,content:a,node_id:e,tags:this.tagCheckList.map(t=>t.tagName),isPublisher:!0}));i.close(),t.success&&(this.$message.success("发帖成功！"),this.tagsList=[],this.crateArticleQuest.title="",this.tagCheckList=[],this.tagsList=h["d"],this.tagsCopyList=h["d"],this.tagText="",this.tagPage=1,this.$refs.editor.clear())}catch(s){i.close(),this.$message.error(s.toString())}}})},searchKeyword:Object(u["debounce"])((function(){let t="";try{t=JSON.stringify(this.tagsList)}catch(e){t=JSON.stringify(h["d"])}this.tagsCopyList=JSON.parse(t),""!==this.keyword&&(this.tagsCopyList.results=this.tagsCopyList.results.filter(t=>{if(-1!==t.tagName.indexOf(this.keyword))return t}))}),200),changeTag(t,e){let i=this.tagCheckList.some(e=>{if(e.tagName===t.tagName)return!0});if(i){for(var s=0;s<this.tagCheckList.length;s++)if(this.tagCheckList[s].tagName===t.tagName){this.tagCheckList.splice(s,1);break}this.tagText=this.tagCheckList.map(t=>"#"+t.tagName).join(" ")}else{if(5===this.tagCheckList.length)return void this.$message.warning("帖子标签最多显示5个!");this.tagCheckList.push(t),this.tagText=this.tagCheckList.map(t=>"#"+t.tagName).join(" ")}},closeTag(){this.visible=!1,this.tagPage=1},async turnTags(){let t=Math.ceil(this.tagsList.page.total/this.tagsList.page.limit);if(this.tagPage<t){this.tagPage+=1;try{const t=await Object(d["g"])({page:this.tagPage});this.tagsList=t.data||h["d"];let i="";try{i=JSON.stringify(t.data)}catch(e){i=JSON.stringify(h["d"])}this.tagsCopyList=JSON.parse(i)}catch(e){this.$message.error(e.toString())}}else{this.tagPage=1;try{const t=await Object(d["g"])({page:this.tagPage});this.tagsList=t.data||h["d"];let i="";try{i=JSON.stringify(t.data)}catch(e){i=JSON.stringify(h["d"])}this.tagsCopyList=JSON.parse(i)}catch(e){this.$message.error(e.toString())}}},OkTags(){this.visible=!1},async visibleTags(){try{const e=await Object(d["g"])({page:this.tagPage});this.tagsList=e.data||h["d"];let i="";try{i=JSON.stringify(e.data)}catch(t){i=JSON.stringify(h["d"])}this.tagsCopyList=JSON.parse(i),this.visible=!this.visible}catch(t){this.$message.error(t.toString())}},visibleAction(){this.extraVisible=!0},handleSubmit(t){t.preventDefault(),this.form.validateFields((t,e)=>{})},handleSelectChange(t){this.form.setFieldsValue({note:`Hi, ${"male"===t?"man":"lady"}!`})}},components:{BaseHeaderLayout:l["a"],Editor:c["a"]}},v=f,y=(i("3753"),i("2877")),b=Object(y["a"])(v,s,a,!1,null,null,null);e["default"]=b.exports},c06a:function(t,e,i){},c10a:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"giftpopup",on:{click:function(t){return t.stopPropagation(),(()=>{}).apply(null,arguments)}}},[e("div",{},[e("el-tabs",{attrs:{type:"border-card"},on:{"tab-click":t.handleClick},model:{value:t.active,callback:function(e){t.active=e},expression:"active"}},[e("el-tab-pane",{attrs:{label:"钻石礼物",name:"1"}},[t.loading>=1&&1==t.active?e("gift-list",{attrs:{userId:t.isuserId,dataList:t.diamondList,type:1,money:t.money,sourceType:t.sourceType,sourceId:t.topic.user.id==t.isuserId?t.sourceId:0},on:{updateMoney:t.updateMoney,close:t.hideBox}}):e("div",{staticClass:"gift-loading"},[e("span",[t._v("加载中...")]),e("i",{staticClass:"el-icon-loading"})])],1),e("el-tab-pane",{attrs:{label:"金币礼物",name:"2"}},[t.loading>=2&&2==t.active?e("gift-list",{attrs:{userId:t.isuserId,dataList:t.goldList,type:2,money:t.money,sourceType:t.sourceType,sourceId:t.topic.user.id==t.isuserId?t.sourceId:0},on:{updateMoney:t.updateMoney,close:t.hideBox}}):e("div",{staticClass:"gift-loading"},[e("span",[t._v("加载中...")]),e("i",{staticClass:"el-icon-loading"})])],1)],1)],1)])},a=[],o=(i("e612"),i("450d"),i("dd87")),n=i.n(o),r=(i("075a"),i("72aa")),l=i.n(r),c=(i("14d9"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"giftlist"},[e("ul",{staticClass:"list-box"},[t._l(t.showList,(function(i,s){return e("li",{key:s,class:{"gift-active":t.giftActive==s,"pack-prop":1==t.type&&2==i.itemType},on:{click:function(e){return t.setActiveGift(s)}}},[e("img",{attrs:{src:i.img,alt:""}}),e("div",{staticStyle:{"font-size":"15px"}},[t._v(t._s(i.name))]),1==i.itemType?e("div",{staticClass:"money",attrs:{data:i.moneyType}},[t._v(" "+t._s(1==i.moneyType?i.goldSalePrice:t.MoneyShow(i.diamondSalePrice,2))+t._s(t._f("moneyType")(i.moneyType))+" ")]):e("div",{staticClass:"money"},[0!=i.goldSalePrice?e("span",[t._v(t._s(i.goldSalePrice)+"币/")]):t._e(),t._v(t._s(t._f("diamondShow")(i.diamondSalePrice))+"钻 ")]),i.quantity?e("span",{staticClass:"num"},[t._v("×"+t._s(i.quantity))]):t._e(),4==t.type&&2==i.itemType&&i.goldSalePrice>0?e("span",{staticClass:"proprighttop"},[t._v("活动")]):t._e()])})),0==t.showList.length?e("div",{staticClass:"nohas"},[t._v("什么也没有~")]):t._e()],2),e("div",{staticClass:"money-box"},[e("span",{directives:[{name:"show",rawName:"v-show",value:2==t.type,expression:"type == 2"}]},[e("img",{attrs:{src:"/images/common/gold.png",alt:""}}),e("span",[t._v(t._s(t.money.gold))])]),e("span",{directives:[{name:"show",rawName:"v-show",value:1==t.type,expression:"type == 1"}]},[e("img",{attrs:{src:"/images/common/diamond.png",alt:""}}),e("span",[t._v(t._s(t._f("diamondShow")(t.money.diamond)))])]),e("i",{staticClass:"el-icon-arrow-right"})]),e("div",{staticClass:"bottom-box"},[e("div",[e("el-pagination",{attrs:{background:"","page-size":12,"prev-text":"上一页","next-text":"下一页","current-page":t.dataList.page.page,layout:"prev, pager, next",total:t.dataList.page.total},on:{"current-change":t.currentPage}})],1),e("div",{staticClass:"btn-box",attrs:{data:t.type}},[e("button",{staticClass:"close hjbox-cursor",staticStyle:{"margin-right":"20px"},on:{click:t.close}},[t._v("取消")]),e("div",{staticClass:"gift-box-inum"},[e("el-input-number",{style:4==t.type?"border-right:1px solid #388DEA":"",attrs:{size:"mini",max:9999},model:{value:t.num,callback:function(e){t.num=e},expression:"num"}}),e("button",{staticClass:"hjbox-cursor",on:{click:t.buyGift}},[t._v("赠送")])],1)])])])}),d=[],h=(i("9d4c"),i("e450")),u=i.n(h),p=(i("672e"),i("101e")),m=i.n(p),g=i("4733"),f=i("b5aa"),v={name:"giftList",components:{ElPagination:m.a,ElInputNumber:u.a},props:{sourceType:{type:Number,default:0,validator:function(t){return[0,1,2].includes(t)}},sourceId:{type:Number,default:0},userId:{type:[Number,String],default:0},type:{type:Number,default:1},dataList:{type:Object,default:{list:[],page:{page:1,total:0}}},money:{type:Object,default:{gold:0,diamond:0}}},data(){return{num:1,showList:[],giftActive:0,propShowGoldbtn:!0}},methods:{setActiveGift(t){1==this.showList[t].itemType||1!=this.type?(this.giftActive=t,0==this.showList[t].goldSalePrice?this.propShowGoldbtn=!1:this.propShowGoldbtn=!0):this.$message.error("不能赠送道具")},close(){this.$emit("close")},async sendGift(){try{await Object(f["R"])({user_id:this.userId,item_id:this.showList[this.giftActive].itemId,quantity:this.num,moneyType:this.showList[this.giftActive].moneyType});this.showList[this.giftActive].quantity-=this.num,this.$message.success("赠送成功")}catch(t){this.$message.error(t)}},async buyGift(){try{const t=this.num,e=this.showList[this.giftActive];let i=0,s=null;const a=this.money;if(2==e.moneyType){const o=Object(g["a"])(a.diamond,100),n=Object(g["a"])(e.diamondSalePrice,100);i=Object(g["b"])(n,t),i>o&&(s="钻石")}else{if(1!=e.moneyType)return!1;{const o=Object(g["a"])(e.goldSalePrice,1);i=Object(g["b"])(o,t),i>a.gold&&(s="金币")}}if(s)this.$hjConfirm(s+"余额不足,是否前往充值",{title:"余额不足",okText:"去充值",async onOk(){2==e.moneyType?window.open(window.location.origin+"/personal/wallet"):window.open(window.location.origin+"/personal/wallet?moneytype=1")}});else{const s=this,a={itemId:e.itemId,quantity:t,moneyType:e.moneyType,userId:this.userId},o=this.sourceId,n=this.sourceType;o&&n&&(a.sourceId=o,a.sourceType=n),this.$hjConfirm(`赠送${a.quantity}个${e.name},需花费${i}${2==a.moneyType?"钻石":"金币"},是否赠送`,{okText:"确认",async onOk(){s.onbuyGift(a)}})}}catch(t){console.error(t)}},async onbuyGift(t){try{let e=await Object(f["d"])(t);this.$emit("updateMoney",e.data),this.$message.success("赠送成功")}catch(e){this.$message.error(e)}},currentPage(t){this.showList=this.dataList.list[t-1]}},created(){if(this.dataList.list.length>0){this.showList=this.dataList.list[0];let t=!1;this.showList.forEach((e,i)=>{t||1==e.itemType&&(t=!0,this.giftActive=i)}),this.showList&&this.showList.length>0&&(this.showList[this.giftActive].goldSalePrice>0?this.propShowGoldbtn=!0:this.propShowGoldbtn=!1)}}},y=v,b=(i("9c3b"),i("69ae"),i("2877")),_=Object(b["a"])(y,c,d,!1,null,"48e06830",null),w=_.exports,C={name:"giftpopup",components:{ElTabs:l.a,ElTabPane:n.a,giftList:w},props:{isuserId:{type:Number,default:0},sourceType:{type:Number,default:0,validator:function(t){return[0,1,2].includes(t)}},sourceId:{type:Number,default:0},topic:{type:Object,default:{}}},data(){return{active:"1",myPack:{list:[],page:{page:1,total:0}},goldList:{list:[],page:{page:1,total:0}},diamondList:{list:[],page:{page:1,total:0}},propList:{list:[],page:{page:1,total:0}},loading:0,money:{gold:0,diamond:0}}},computed:{},watch:{},methods:{updateMoney(t){this.money=t},handleClick(t){0==t.index&&this.loading<1?this.getDiamondList():1==t.index&&this.loading<2&&this.getGoldList()},hideBox(){this.$emit("hideBox")},async getPropList(){try{let t=await Object(f["z"])({itemType:"prop",limit:100,type:""});if(this.propList.list=[],t.data.results&&t.data.results.length>0)if(this.propList.page.total=t.data.page.total,t.data.results.length<=12){let e=t.data.results;this.propList.list.push(e)}else{let e=[];t.data.results.forEach((i,s)=>{e.push(i),12!=e.length&&s!=t.data.results.length-1||(this.propList.list.push(e),e=[])})}else this.$message.error("没有道具");this.loading=4}catch(t){this.$message.error(t)}},async getGoldList(){try{let t=await Object(f["z"])({itemType:"gift",type:"gold",limit:100,page:1});if(this.goldList.list=[],t.data.results&&t.data.results.length>0)if(this.goldList.page.total=t.data.page.total,t.data.results.length<=12){let e=t.data.results;this.goldList.list.push(e)}else{let e=[];t.data.results.forEach((i,s)=>{e.push(i),12!=e.length&&s!=t.data.results.length-1||(this.goldList.list.push(e),e=[])})}else this.$message.error("没有金币礼物");this.loading=2}catch(t){this.$message.error(t)}},async getDiamondList(){try{let t=await Object(f["z"])({itemType:"gift",type:"diamond",limit:100,page:1});if(this.diamondList.list=[],t.data.results&&t.data.results.length>0)if(this.diamondList.page.total=t.data.page.total,t.data.results.length<=12){let e=t.data.results;this.diamondList.list.push(e)}else{let e=[];t.data.results.forEach((i,s)=>{e.push(i),12!=e.length&&s!=t.data.results.length-1||(this.diamondList.list.push(e),e=[])})}else this.$message.error("没有钻石礼物");this.loading=1}catch(t){this.$message.error(t)}},async getUserMoney(){try{let t=await Object(f["D"])();this.money=t.data,this.$store.commit("updateMoney",t.data)}catch(t){this.$message.error(t)}},async getPackList(){try{let t=0;this.loading>1&&(t=this.loading,this.loading=0);const e=await Object(f["s"])();if(this.myPack.list=[],e.data&&e.data.length>0)if(e.data.sort((function(t,e){return t.itemType-e.itemType})),this.myPack.page.total=e.data.length,e.data.length<=12){let t=e.data;this.myPack.list.push(t)}else{let t=[];e.data.forEach((i,s)=>{t.push(i),12!=t.length&&s!=e.data.results.length-1||(this.myPack.list.push(t),t=[])})}this.loading=t<1?1:t}catch(t){this.$message.error(t)}}},created(){this.getDiamondList(),this.getUserMoney()},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},x=C,k=(i("9f1d"),i("e3eb"),Object(b["a"])(x,s,a,!1,null,"7f801188",null));e["a"]=k.exports},c1e9:function(t,e,i){},c3a2:function(t,e,i){},c4e8:function(t,e,i){},d9ef:function(t,e,i){},e3eb:function(t,e,i){"use strict";i("c4e8")},e795:function(t,e,i){"use strict";i("a478")},e836:function(t,e,i){"use strict";i.r(e);i("14d9");var s=function(){var t=this,e=t._self._c;return e("div",{staticClass:"details-box",staticStyle:{"min-height":"100%","margin-top":"45px"}},[e("el-dialog",{attrs:{top:"10vh","show-close":!1,visible:t.shows,"modal-append-to-body":!1,width:"420px","custom-class":"hj-dialog-saves"},on:{"update:visible":function(e){t.shows=e}}},[e("template",{slot:"title"},[e("div",{staticClass:"hj-dialog-header",on:{click:function(e){t.shows=!1}}},[e("div",{staticClass:"icon-close",on:{click:function(e){t.shows=!1}}},[e("i",{staticClass:"el-icon-close"})]),e("div",{staticClass:"title"},[e("span",[t._v("你正在移动1个帖子到")]),e("br"),e("span",{staticClass:"sub-title"},[t._v("请选择")])])])]),e("div",{staticClass:"d-line"}),e("div",{staticClass:"hj-dialog-body"},[t._l(t.datalist0,(function(i,s){return e("div",{staticClass:"body-item"},[e("el-radio",{attrs:{label:i.id},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}},[t._v(t._s(i.name))]),e("span",[t._v(t._s(i.count))])],1)})),t.firstStep?e("div",{staticClass:"add-save-btn",on:{click:function(e){t.firstStep=!1}}},[e("img",{attrs:{src:"/images/common/add.png",alt:""}}),e("span",[t._v("新建收藏夹")])]):e("div",{staticClass:"add-save-btn2"},[e("el-input",{staticClass:"text-right c-pointer article-search",staticStyle:{width:"100%","border-radius":"0"},attrs:{placeholder:"最多输入xx个字",size:"mini"},model:{value:t.keyword,callback:function(e){t.keyword=e},expression:"keyword"}},[e("el-button",{attrs:{slot:"append"},on:{click:function(e){return t.addSaveHttp(t.keyword)}},slot:"append"},[t._v("新建")])],1)],1),e("div",{staticClass:"bot-line"}),e("div",{staticClass:"button",on:{click:t.transfer}},[t._v("确认")])],2)],2),e("div",{style:{position:"fixed",left:(Number(t.screenW)<1360?(t.screenW-1030)/2-180:(t.screenW-1e3)/2-200)+"px"}},[e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_LTKEY}}),e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_LBKEY}})],1),e("div",{style:{position:"fixed",right:(Number(t.screenW)<1360?(t.screenW-1030)/2-180:(t.screenW-1e3)/2-200)+"px"}},[e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_RTKEY}}),e("advertising",{attrs:{limit:1,nopadding:!0,showtype:0,position:t.AD_DETAILS_RBKEY}})],1),e("advertising",{attrs:{showtype:1,position:t.AD_DETAILS_LLKEY}}),e("advertising",{attrs:{showtype:2,position:t.AD_DETAILS_LRKEY}}),e("div",{attrs:{id:"details-page"}},[e("hj-gap",{attrs:{height:16}}),e("div",{staticClass:"details-breadcrumb"},[e("div",{on:{click:function(e){return t.$router.push("/")}}},[t._v("首页")]),t.breadcrumbResp.parent?e("i",{staticClass:"el-icon-arrow-right"}):t._e(),t.breadcrumbResp.parent?e("div",{on:{click:function(e){return t.tagclick(t.breadcrumbResp.parent)}}},[t._v(t._s(t.breadcrumbResp.parent.name))]):t._e(),t.breadcrumbResp.children?e("i",{staticClass:"el-icon-arrow-right"}):t._e(),t.breadcrumbResp.children?e("div",{on:{click:function(e){return t.tagclick(t.breadcrumbResp.children)}}},[t._v(t._s(t.breadcrumbResp.children.name))]):t._e(),t.articleInfo&&t.articleInfo.node?e("i",{staticClass:"el-icon-arrow-right"}):t._e(),t.articleInfo&&t.articleInfo.node?e("div",{on:{click:function(e){return t.$router.push({path:"/addArticle",query:{nodeId:t.articleInfo.node.nodeId}})}}},[t._v(" [我要发帖] ")]):t._e()]),e("div",{staticClass:"header"},[e("h2",{staticClass:"position-relative"},[e("span",[t._v(t._s(t.articleInfo.title||""))]),1==t.articleInfo.type&&Object.keys(t.articleInfo.sale||{}).length>0?e("small",{staticClass:"extra font-12 currency"},[t._v("本贴售价："+t._s(t.MoneyShow(t.articleInfo.sale.amount,t.articleInfo.sale.money_type))+t._s(1==t.articleInfo.sale.money_type?"金币":"钻石"))]):t._e(),2==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&t.articleInfo.reward.reward_reply_floor>0?e("a",{staticClass:"extra font-12",attrs:{href:"javascript:void(0);"}},[t._v(" 已结束，最佳答案为"+t._s(t.articleInfo.reward.reward_reply_floor+1)+"楼 ")]):t._e(),2==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&1==t.articleInfo.reward.reward_status&&0==t.articleInfo.reward.reward_reply_floor?e("a",{staticClass:"extra font-12",attrs:{href:"javascript:void(0);"}},[t._v(" 已提前终止 ")]):t._e(),2==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&0==t.articleInfo.reward.reward_status&&!t.fromType?e("small",{staticClass:"extra font-12 currency"},[t._v("悬赏中："+t._s(t.MoneyShow(t.articleInfo.reward.amount,t.articleInfo.reward.money_type))+t._s(1==t.articleInfo.reward.money_type?"金币":"钻石"))]):t._e(),2==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&0==t.articleInfo.reward.reward_status&&"reward"==t.fromType?e("button",{staticClass:"stopreward-btn",on:{click:t.stopReward}},[t._v(" 提前结束 ")]):t._e()]),t.articleInfo.tags&&Array.isArray(t.articleInfo.tags)?e("div",{staticClass:"mb-3 d-flex justify-content-center"},t._l(t.articleInfo.tags||[],(function(i,s){return e("a",{key:s,staticClass:"font-14",staticStyle:{margin:"0 15px"},attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.searchTags(i.tagName)}}},[t._v("#"+t._s(i.tagName||""))])})),0):t._e(),e("div",{staticClass:"statistics"},[e("div",{staticClass:"atl-info text-center",staticStyle:{"font-size":"13px"}},[e("span",[t._v("楼主："),e("a",{staticClass:"hjbox-linkcolor",attrs:{href:"javascript:void(0);",title:t.articleInfo&&t.articleInfo.user?t.articleInfo.user.nickname:""},on:{click:function(e){return t.toUserInfo(t.articleInfo.user.id)}}},[t._v(t._s(t.articleInfo&&t.articleInfo.user?t.articleInfo.user.nickname:""))])]),t.articleInfo&&t.articleInfo.user&&t.articleInfo.user.vip?e("hj-level",{staticClass:"d_level ml-1 hjbox-cursor",on:{onlevel:t.govip}},[t._v(t._s(t.articleInfo&&t.articleInfo.user&&t.articleInfo.user.vip?t.articleInfo.user.vip:0))]):t._e(),e("span",{staticClass:"ml-1"},[t._v("时间："+t._s(t.articleInfo&&t.articleInfo.createTime?t.articleInfo.createTime:""))]),e("span",{staticClass:"ml-1"},[t._v("点击："+t._s(t._f("newshowNumber")(t.articleInfo&&t.articleInfo.viewCount)))]),e("span",{staticClass:"ml-1"},[t._v("回复："+t._s(t._f("newshowNumber")(t.articleInfo&&t.articleInfo.commentCount)))]),e("span",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"ml-1"},[t._v("被收藏"+t._s(t.articleInfo.likeCount||0)+"次")])],1),e("div",{staticClass:"article-handle d-flex justify-content-between"},[e("div",{staticClass:"menu"},[t.isvipLimit?t._e():[e("el-button",{directives:[{name:"show",rawName:"v-show",value:2!=t.searchType,expression:"searchType != 2"}],staticClass:"article-btn",attrs:{title:"脱水"},on:{click:function(e){return t.getReplyList(2)}}},[t._v("脱水")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:0!=t.searchType,expression:"searchType != 0"}],staticClass:"article-btn",attrs:{title:"看全部"},on:{click:function(e){return t.getReplyList(0)}}},[t._v("看全部")]),e("el-button",{directives:[{name:"show",rawName:"v-show",value:1!=t.searchType,expression:"searchType != 1"}],staticClass:"article-btn",attrs:{title:"看楼主"},on:{click:function(e){return t.getReplyList(1)}}},[t._v("看楼主")]),e("el-button",{staticClass:"article-btn",attrs:{title:"打赏"},on:{click:function(e){return t.showGift(0)}}},[t._v("打赏")])],e("el-popover",{attrs:{placement:"bottom",width:"400",trigger:"hover"}},[e("el-button",{staticClass:"article-btn",attrs:{slot:"reference"},slot:"reference"},[t._v("设置")]),e("div",{staticClass:"font-set-view"},[e("p",[e("strong",[t._v("背景：")]),e("span",{staticClass:"btn-color",class:"#f5f9fA"===t.colorSel&&"btn-color-sel",attrs:{id:"btn_color_1"},on:{click:function(e){return t.changeBg("#f5f9fA")}}}),e("span",{staticClass:"btn-color",class:"#f9fcf5"===t.colorSel&&"btn-color-sel",attrs:{id:"btn_color_2"},on:{click:function(e){return t.changeBg("#f9fcf5")}}}),e("span",{staticClass:"btn-color",class:"#fff3f7"===t.colorSel&&"btn-color-sel",attrs:{id:"btn_color_3"},on:{click:function(e){return t.changeBg("#fff3f7")}}}),e("span",{staticClass:"btn-color",class:"#fefbf6"===t.colorSel&&"btn-color-sel",attrs:{id:"btn_color_4"},on:{click:function(e){return t.changeBg("#fefbf6")}}}),e("span",{staticClass:"btn-color",class:"#f8f8f8"===t.colorSel&&"btn-color-sel",attrs:{id:"btn_color_5"},on:{click:function(e){return t.changeBg("#f8f8f8")}}})])]),1==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&0==t.articleInfo.reward.reward_status?e("span",{staticClass:"currency font-12 ml-1"},[t._v("距悬赏结束还有"+t._s(t._f("formatSeconds")(t.articleInfo.reward.reward_exp_time)))]):t._e()],1),Object.keys(t.userInfo).length>0&&t.userInfo.id===t.articleInfo.user.id?e("a",{staticClass:"article-btn",attrs:{href:`/updateArticle?topic_id=${t.$route.query.pid}&topic_pending_id=0`}},[t._v("编辑帖子")]):t._e(),Object.keys(t.userInfo).length>0&&t.userInfo.id===t.articleInfo.user.id?e("el-button",{staticClass:"article-btn",attrs:{title:"置顶"},on:{click:function(e){t.$refs.topcard&&t.$refs.topcard.onshow()}}},[t._v("置顶 ")]):t._e(),Object.keys(t.userInfo).length>0&&t.userInfo.id===t.articleInfo.user.id&&t.articleInfo.is_top?e("span",{staticStyle:{color:"#ff712b"}},[t._v("置顶有效期至"+t._s(t.articleInfo.topExpiresTime))]):t._e()],2),e("el-pagination",{staticClass:"newpages",attrs:{size:"small",background:"",layout:"prev, pager, next,jumper,slot","current-page":t.current,"page-size":t.commentList.page.limit,total:t.commentList.page.total,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":t.onChangePagination}},[e("button",{staticClass:"article-btn",staticStyle:{"margin-left":"10px","border-radius":"0"},on:{click:function(e){return t.onChangePagination(t.current,20)}}},[t._v(" 确定 ")])])],1)])]),e("hj-gap",{attrs:{height:22}}),t.current<=1?e("div",{staticClass:"floor-show"},[e("div",{staticClass:"floor_box",attrs:{"data-topicfloor":"topic"}},[t.updateTopic&&t.articleInfo.content?e("div",{directives:[{name:"content",rawName:"v-content",value:[t.articleInfo.content,t.articleInfo.attachments,t.articleInfo.sale,this,t.articleInfo],expression:"[articleInfo.content, articleInfo.attachments, articleInfo.sale, this, articleInfo]"}],staticClass:"article ql-editor",on:{click:t.contentClick}}):t._e(),t.articleInfo&&t.articleInfo.node?[t.isvipLimit?[e("vip-limit",{attrs:{vipLimit:t.articleInfo.node.vipLimit}})]:[e("div",{directives:[{name:"show",rawName:"v-show",value:t.ishow,expression:"ishow"}],staticClass:"action-tyf d-flex justify-content-center mt-2"},[e("div",{staticClass:"action-shang",on:{click:function(e){return t.showGift(0)}}},[e("a",{staticClass:"shang",attrs:{href:"javascript:void(0)"}}),e("p",[t._v("打赏")])]),e("div",{staticClass:"action-tyf-zan",on:{click:t.handleLink}},[e("a",{staticClass:"zan",class:t.likeState?"":"d",attrs:{href:"javascript:void(0)"}}),e("p",[e("em",{staticStyle:{display:"inline"}},[e("span",[t._v(t._s(t.articleInfo.likeCount||0))]),t._v("人")]),t._v("点赞 ")])]),e("div",{staticClass:"action-tyf-cang",on:{click:function(e){t.articleInfo.folderId?t.handleCollect(2):t.shows=!0}}},[e("a",{staticClass:"cang",class:t.articleInfo.folderId?"":"d",attrs:{href:"javascript:void(0)"}}),e("p",[e("em",{staticStyle:{display:"inline"}},[e("span",[t._v(t._s(t.articleInfo.folderId?1:0))]),t._v("人")]),t._v("收藏 ")])]),1==t.articleInfo.type?e("div",{staticClass:"action-buy",on:{click:function(e){return t.handleBuy(t.articleInfo,0,null)}}},[e("a",{staticClass:"buy",class:t.articleInfo.sale.is_buy?"":"d",attrs:{href:"javascript:void(0)"}}),e("p",[t._v(t._s(t.articleInfo.sale.is_buy?"已购买":"购买"))])]):t._e(),3==t.articleInfo.type?e("div",{staticClass:"action-dy",on:{click:function(e){return t.handleSubscribe(t.articleInfo)}}},[e("a",{class:{dy_disable:!t.articleInfo.is_subscribe,dy:t.articleInfo.is_subscribe},attrs:{href:"javascript:void(0)"}}),e("p",[t._v(t._s(t.articleInfo.is_subscribe?"已":"")+"订阅")])]):t._e()]),e("ranking-list",{attrs:{topicId:parseInt(t.$route.query.pid)||0},on:{exceptional:()=>{t.showGift(0)}}}),t._m(0),e("div",{staticClass:"url-box"},[e("div",{staticClass:"hjbox-linkline hjbox-linkcolor"},[e("a",{attrs:{href:t.$store.state.configUrl.domainAbroad,target:"_blank"}},[e("span",[t._v(t._s(t.MainObj.name)+"社区海外网址：")]),e("span",[t._v(t._s(t.$store.state.configUrl.domainAbroad?t.$store.state.configUrl.domainAbroad:"暂无"))])])]),e("div",{staticClass:"hjbox-linkline hjbox-linkcolor"},[e("a",{attrs:{href:t.$store.state.configUrl.domain,target:"_blank"}},[e("span",[t._v(t._s(t.MainObj.name)+"社区国内网址：")]),e("span",[t._v(t._s(t.$store.state.configUrl.domain?t.$store.state.configUrl.domain:"暂无"))])])]),e("div",{staticClass:"hjbox-linkline hjbox-cursor"},[e("span",[t._v(t._s(t.MainObj.name)+"社区客服联系方式：")]),e("span",[t._v(t._s(t.$store.state.configUrl.customerService?t.$store.state.configUrl.customerService:"暂无"))])])])]]:t._e()],2)]):t._e(),e("advertising",{attrs:{showtype:0,position:t.AD_DETAILS_CTKEY}}),t.isvipLimit?t._e():[t.floorUpdate?[t._l(t.commentList.results||[],(function(i,s){return[e("div",{key:"list"+s},[e("div",{staticClass:"author text-center",staticStyle:{margin:"10px 0"}},[e("a",{attrs:{href:"/homepage/"+i.user_id,target:"_blank"}},[t._v("作者： "),e("span",{staticClass:"hjbox-linkline"},[t._v(t._s(i.nickname||""))])]),i.vip?e("hj-level",{staticClass:"d_level ml-2 hjbox-cursor",on:{onlevel:t.govip}},[t._v(t._s(i.vip))]):t._e(),e("span",{staticClass:"ml-2"},[t._v("时间："+t._s(i.create_time))])],1),e("div",{staticClass:"floor-show hjbox-container"},[e("div",{staticClass:"floor_box",attrs:{"data-topicfloor":s,"data-floor-money":i.price,"data-floor-index":i.floor,"data-floor-id":i.reply_id}},[t.updateContent?e("div",{directives:[{name:"content",rawName:"v-content",value:[i.content,i.attachments,{money_type:t.articleInfo.sale?t.articleInfo.sale.money_type:null,amount:i.price,buyCount:i.buyCount},this,t.articleInfo],expression:"[\n                                    result.content,\n                                    result.attachments,\n                                    {\n                                        money_type: articleInfo.sale ? articleInfo.sale.money_type : null,\n                                        amount: result.price,\n                                        buyCount: result.buyCount,\n                                    },\n                                    this,\n                                    articleInfo,\n                                ]"}],staticClass:"article-content",on:{click:t.contentClick}}):t._e(),e("div",{staticClass:"overflow-hidden"},[2==t.articleInfo.type&&Object.keys(t.articleInfo.reward||{}).length>0&&0==t.articleInfo.reward.reward_status&&"reward"==t.fromType?e("div",{staticClass:"atl-reply"},[e("span",[t._v(t._s(i.floor+1)+"楼")]),t._v(" | "),e("span",{staticClass:"set-reward",on:{click:function(e){return t.setReward(i)}}},[t._v("选为最佳答案")])]):e("div",{staticClass:"atl-reply"},[e("span",[t._v(t._s(i.floor+1)+"楼")]),t._v(" | "),i.is_sale&&t.articleInfo.sale&&-1!=i.content.indexOf("sell-btn")?e("a",{staticClass:"a-link-2 reply hjbox-linkline",attrs:{href:"javascript:void(0);",title:"引用点赞"},on:{click:function(e){return t.handleBuy(t.articleInfo,1,i)}}},[t._v("购买("+t._s(t.MoneyShow(i.price,t.articleInfo.sale.money_type))+t._s(1==t.articleInfo.sale.money_type?"金币":"钻石")+")｜")]):t._e(),e("a",{staticClass:"a-link-2 reply hjbox-linkline",attrs:{href:"javascript:void(0);",title:"引用点赞"},on:{click:function(e){return t.showGift(i.user_id)}}},[t._v("打赏")]),t._v(" | "),e("a",{staticClass:"a-link-2 ir-remark hjbox-linkline",attrs:{href:"javascript:void(0);",title:"插入评论"},on:{click:function(e){return t.changeTextarea(i,"")}}},[t._v("评论("+t._s(i.comment_count)+")")])])]),e("div",{staticClass:"item-reply-view"},[e("div",{staticClass:"ir-list"},[e("ul",t._l(i.comment_list.list||[],(function(s,a){return e("li",{key:a},[e("p",[e("a",{staticClass:"ir-user hjbox-linkline",class:{"ir-lz-user":s.user_id==t.articleInfo.user.id},attrs:{href:"/homepage/"+s.user_id,target:"_blank"}},[t._v(t._s(s.nickname||"")+"：")]),t._m(1,!0),e("span",[t._v(t._s(s.createTime||""))]),t._v("  "),e("a",{staticClass:"a-link2 ir-reply hjbox-linkline",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.changeTextarea(i,s)}}},[t._v("评论")])]),s.quote&&Object.keys(s.quote).length>0?e("span",{staticClass:"ir-content"},[t._v("评论 "),e("a",{staticClass:"hjbox-linkline",attrs:{href:"/homepage/"+s.quote.user_id}},[t._v(t._s(s.quote.nickname||""))]),t._v("： "),e("span",{domProps:{textContent:t._s(s.content)}})]):e("span",{staticClass:"ir-content",domProps:{textContent:t._s(s.content)}})])})),0)]),e("div",{staticClass:"ir-action"},[e("div",{staticClass:"ir-action-btn"},[i.comment_count>0&&!i.comment_list.lastPage?e("span",{staticClass:"a-link ir-remain"},[t._v("剩余"),e("span",{staticClass:"ir-count"},[t._v(t._s(i.comment_count-i.comment_list.list.length))]),t._v("条评论")]):t._e(),t._v("  "),i.comment_count>0&&!i.comment_list.lastPage?e("a",{staticClass:"btn-more",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.fetchItemReply(i.reply_id,i.comment_list.page,s)}}},[t._v("点击查看")]):t._e(),i.comment_count>0&&i.comment_list.lastPage?e("a",{staticClass:"btn-more hjbox-linkline",attrs:{href:"javascript:void(0);"},on:{click:function(e){return t.resetItemReply(s)}}},[t._v("收起评论")]):t._e(),e("span",{staticClass:"ir-action-add",on:{click:function(e){return t.changeTextarea(i,"")}}},[t._v("我要评论")])])]),e("div",{directives:[{name:"show",rawName:"v-show",value:i.textareaObj.visibleTextarea,expression:"result.textareaObj.visibleTextarea"}],staticClass:"ir-post"},[e("div",{staticClass:"ir-post-arrow"}),e("div",{staticClass:"ir-post-border clearfix"},[e("textarea",{directives:[{name:"model",rawName:"v-model",value:i.textareaObj.textareaContent,expression:"result.textareaObj.textareaContent"}],staticClass:"ir-post-input",attrs:{cols:"0",placeholder:i.textareaObj.placeholder},domProps:{value:i.textareaObj.textareaContent},on:{input:function(e){e.target.composing||t.$set(i.textareaObj,"textareaContent",e.target.value)}}}),e("div",{staticClass:"ir-post-long"},[t._v(" 还可以输入"),e("strong",[t._v(t._s(140-i.textareaObj.textareaContent.length))]),t._v("字 ")])]),e("div",{staticClass:"ir-post-btn"},[e("input",{staticClass:"ir-post-submit",attrs:{type:"button",value:"发 表"},on:{click:function(e){return t.postCommentSubmit(i,s)}}})])])])])])]),9==s?e("div",{key:"gu"+s},[e("advertising",{attrs:{showtype:0,position:t.AD_DETAILS_CCKEY}})],1):t._e()]}))]:[t._m(2)]],e("el-pagination",{staticClass:"newpages",staticStyle:{"text-align":"right","margin-top":"10px"},attrs:{size:"small",background:"",layout:"prev, pager, next,jumper,slot","current-page":t.current,"page-size":t.commentList.page.limit,total:t.commentList.page.total,"prev-text":"上一页","next-text":"下一页"},on:{"current-change":t.onChangePagination}},[e("button",{staticClass:"article-btn",staticStyle:{"margin-left":"10px","border-radius":"0"},on:{click:function(e){return t.onChangePagination(t.current,20)}}},[t._v(" 确定 ")])]),!t.isvipLimit&&t.floorUpdate&&t.commentList.page.total?[e("advertising",{attrs:{showtype:0,position:t.AD_DETAILS_CBKEY}})]:t._e(),t.isvipLimit?t._e():[e("hj-gap",{attrs:{height:20}}),Object.keys(t.userInfo).length>0?e("div",[e("span",{attrs:{id:"author_name_reply"}},[t.userInfo.avatar&&""!==t.userInfo.avatar&&-1!=t.userInfo.avatar.indexOf("http")?e("img",{attrs:{src:t.userInfo.avatar}}):t.userInfo.avatar&&""!==t.userInfo.avatar&&-1==t.userInfo.avatar.indexOf("http")?e("img",{attrs:{src:`/images/common/avatar/${t.userInfo.avatar}.jpg`}}):e("img",{staticClass:"avatar c-pointer",attrs:{src:"/images/common/avatar/0.jpg",id:"dropdown_avatar",alt:""}}),t._v(" "+t._s(t.userInfo.nickname||""))]),e("span",[t._v("发表回复")])]):t._e(),e("hj-gap",{attrs:{height:20}}),e("Editor",{ref:"ed",attrs:{topicDetails:t.articleInfo}})]],2),e("BbsTool",{attrs:{isvipLimit:t.isvipLimit,articleInfo:t.articleInfo,"collect-state":t.articleInfo.folderId?1:0},on:{showGift:()=>{t.showGift(0)},clickCollect:t.handleCollect,clickToReply:t.scrollToReply}}),e("div",{directives:[{name:"show",rawName:"v-show",value:t.giftBg,expression:"giftBg"}],staticClass:"gift-bg",on:{click:t.giftHide}},[e("transition",{attrs:{name:"el-zoom-in-top"}},[t.giftBox?e("gift-popup",{attrs:{isuserId:t.isuserId,topic:t.articleInfo,sourceType:1,sourceId:parseInt(t.$route.query.pid)},on:{hideBox:t.giftHide}}):t._e()],1)],1),e("topcard-dialog",{ref:"topcard",attrs:{topicId:t.articleInfo.topicId},on:{success:t.setTopSuccess}}),t.isShowDisCard?e("discount-card",{ref:"dicountCard",attrs:{sellMoney:t.sellMoney,moneyType:t.articleInfo.sale.money_type},on:{puySale:t.buySale,close:t.closeDiscountCard}}):t._e(),t.showBig?e("el-image-viewer",{attrs:{"on-close":t.closeViewer,"url-list":t.showBigList}}):t._e()],1)},a=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"atl-reply"},[e("span",{staticClass:"reportme a-link",staticStyle:{visibility:"hidden"}},[t._v("举报")]),e("span",{staticStyle:{visibility:"hidden"}},[t._v("|")]),t._v(" "),e("span",[t._v("楼主")])])},function(){var t=this,e=t._self._c;return e("span",{staticClass:"ir-power",staticStyle:{display:"none"}},[e("a",{staticClass:"a-link ir-report",attrs:{href:"javascript:void(0);"}},[t._v("举报")]),t._v(" ")])},function(){var t=this,e=t._self._c;return e("div",{staticStyle:{"min-height":"500px","text-align":"center"}},[e("span",{staticStyle:{color:"#aaa"}},[t._v("加载中...")])])}],o=(i("3c65"),i("7e11")),n=i("9d4b"),r=(i("450d"),function(){var t=this,e=t._self._c;return e("div",{staticClass:"_hj-tag d-inline c-pointer",class:t.only&&"only"},[t.only?t._e():e("i",{staticClass:"iconfont icon-qianbao"}),e("span",[t._v(t._s(t.$slots.default[0].text))]),t.only?t._e():e("span",[t._v("10")])])}),l=[],c={props:{only:{type:Boolean,default(){return!1}}},mounted(){}},d=c,h=(i("fa38"),i("2877")),u=Object(h["a"])(d,r,l,!1,null,null,null),p=u.exports,m=i("b509"),g=i("492a"),f=i("6b26"),v=i("bc3a"),y=i.n(v),b=i("546c"),_=function(){var t=this,e=t._self._c;return e("div",{staticClass:"position-fixed",class:t.visible?"visible":"invisible",style:{left:""+t.left,right:""+t.right},attrs:{id:"bbs_float_menu"}},[t._m(0),e("div",{staticClass:"scroll-btn"},[e("a",{staticClass:"s-btn-share",attrs:{href:"javascript:void(0);",title:"分享"}},[e("i",{staticClass:"iconfont icon-iconfontzhizuobiaozhun20 iconShare"}),e("div",{staticClass:"share-wrap box"},[e("div",{staticClass:"img-wap"},[t.articleInfo.attachments&&t.articleInfo.attachments[0]?e("img",{directives:[{name:"lazyloadimg",rawName:"v-lazyloadimg",value:t.articleInfo.attachments[0],expression:"articleInfo.attachments[0]"}],staticClass:"d-block",attrs:{width:"100%",height:"100%"}}):e("img",{staticClass:"d-block",attrs:{width:"100%",height:"100%",src:"/images/common/share.png"}})]),e("div",{staticClass:"text-wap"},[e("h4",[t._v(t._s(t.articleInfo.title||""))]),e("p",{domProps:{innerHTML:t._s(t.desc_f)}})]),e("div",{staticClass:"wx-share-wrap d-flex"},[e("div",{attrs:{id:"qrcode"}}),e("div",{staticClass:"text"},[e("h1",[t._v("【"+t._s(t.MainObj.name)+"社区】")]),e("h2",[t._v("可以聊任意话题的地方")])])])])]),t.isvipLimit?t._e():[e("a",{staticClass:"s-btn dashang-left-btn",attrs:{href:"javascript:void(0);",title:"打赏"},on:{click:t.navigateTo}},[e("i",{staticStyle:{display:"none",left:"0px",top:"0px"}})]),e("a",{staticClass:"s-btn mark-btn cang",class:t.collectState?"ok":"no",attrs:{href:"javascript:void(0);",title:t.collectState?"取消收藏":"收藏"},on:{click:function(e){t.collectState?t.$emit("clickCollect",2):t.$emit("clickCollect")}}},[e("span",{staticClass:"box"},[t._v(t._s(t.collectState?"取消收藏":"收藏本帖"))])]),e("a",{staticClass:"s-btn goto-reply-btn",attrs:{href:"#fabu_anchor",title:"回复"},on:{click:function(e){return t.$emit("clickToReply")}}},[e("span",{staticClass:"box"},[t._v("搬砖回复")])])],t._m(1)],2)])},w=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"shang-move",staticStyle:{display:"none",right:"90px"},attrs:{id:"shang-move"}},[e("div",{staticClass:"shang-move-in",staticStyle:{display:"none"}},[e("p",[t._v("星星眼、礼物和你，"),e("br"),t._v("必须留下一个")])])])},function(){var t=this,e=t._self._c;return e("a",{staticClass:"s-btn scroll-top-btn",attrs:{href:"javascript:scroll(0,0);"}},[e("span",{staticClass:"box"},[t._v("回到顶部")])])}],C=i("d044"),x=i.n(C),k=i("dafe"),L={props:{isvipLimit:{type:Boolean,default:!1},collectState:{type:Number},articleInfo:{type:Object}},data(){return{_time:null,left:"auto",right:"auto",visible:!1,qrcodeObj:{},desc:""}},computed:{desc_f(){if(this.articleInfo&&this.articleInfo.content){let t=Object(k["m"])(this.articleInfo.content);return t.length<64?t:t.slice(0,64)+"..."}return""}},mounted(){const t=document.body.clientWidth;let e=(t-1e3)/2;this.left=1e3+e+10+"px",this.visible=!0;let i=this;i._time=setTimeout(()=>{i.$nextTick(()=>{i._QRCode()})},2200),window.addEventListener("resize",(function(){if(document.body.clientWidth>1e3){let t=(document.body.clientWidth-1e3)/2;i.left=1e3+t+10+"px"}else i.left="auto",i.right="0"}))},destroyed(){this._time&&clearTimeout(this._time)},methods:{_QRCode(){const{address:t}=this.SpliceURL();let e=t+"/post/details?pid="+window.location.href.split("topic_id=")[1];try{this.qrcodeObj=new x.a("qrcode",{text:e,width:75,height:75,colorDark:"#000000",colorLight:"#fff",correctLevel:x.a.CorrectLevel.H})}catch(i){}},navigateTo(){this.$emit("showGift")}}},I=L,T=(i("17c0"),Object(h["a"])(I,_,w,!1,null,null,null)),S=T.exports,$=i("4328"),j=i.n($),O=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"loading",rawName:"v-loading",value:t.spinning,expression:"spinning"}],staticClass:"position-relative",attrs:{id:"editor","element-loading-text":t.loadNum>0?"正在上传..."+t.loadNum+"%":"资源上传中","element-loading-spinner":"el-icon-loading","element-loading-background":"rgba(0, 0, 0, 0.8)"}},[e("section",{staticClass:"container position-relative details-edit"},[e("quill-editor",{ref:"myQuillEditor",attrs:{options:t.editorOption},on:{blur:function(e){return t.onEditorBlur(e)},focus:function(e){return t.onEditorFocus(e)},ready:function(e){return t.onEditorReady(e)}},model:{value:t.content,callback:function(e){t.content=e},expression:"content"}}),e("div",{staticClass:"editorToolBar position-absolute"},[e("span",{staticClass:"friend hjbox-linkcolor",attrs:{title:"朋友"},on:{click:t.showAts}},[t._v("朋友")]),e("span",{staticClass:"photo hjbox-linkcolor",attrs:{title:"图片"},on:{click:t.pickClick}},[t._v("插入")]),e("div",{staticClass:"emoji-btn"},[e("el-popover",{attrs:{placement:"right",width:"360","popper-class":"emojipover",trigger:"click"},model:{value:t.showEmoji,callback:function(e){t.showEmoji=e},expression:"showEmoji"}},[e("emoji",{attrs:{height:"200px",width:"340px"},on:{close:function(e){t.showEmoji=!1},selectEmoji:t.selectEmoji}}),e("el-button",{staticClass:"hjbox-linkcolor",attrs:{slot:"reference",title:"表情"},slot:"reference"},[t._v("表情")])],1)],1),t.topicDetails&&t.topicDetails.sale&&t.uid==t.topicDetails.user.id?e("div",{staticClass:"sell-floor"},[e("el-checkbox",{model:{value:t.checked,callback:function(e){t.checked=e},expression:"checked"}},[t._v("出售该楼层")]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"checked"}],staticClass:"sell-money"},[e("span",[t._v("售价:")]),e("input",{directives:[{name:"model",rawName:"v-model",value:t.floorMoney,expression:"floorMoney"}],attrs:{type:"number",placeholder:"出售金额"},domProps:{value:t.floorMoney},on:{input:function(e){e.target.composing||(t.floorMoney=e.target.value)}}}),e("span",[t._v(t._s(t.topicDetails&&1==t.topicDetails.sale.money_type?"金币":"钻石"))])]),e("div",{directives:[{name:"show",rawName:"v-show",value:t.checked,expression:"checked"}],staticClass:"sell-money set-sell",on:{click:function(e){return t.setSell()}}},[t._v("添加出售内容")])],1):t._e(),e("span",{staticClass:"draft hjbox-linkcolor",attrs:{title:"草稿箱"},on:{click:t.navigatorTo}},[t._v("草稿箱")])]),e("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"file",staticClass:"van-uploader__input",attrs:{type:"file",multiple:"multiple",accept:"image/png,image/jpeg,image/gif,image/jpg"},on:{change:function(e){return t.fileFollowImg(e)}}}),e("input",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],ref:"fileVideo",staticClass:"uploadVideo",attrs:{type:"file",name:"video",id:"video",accept:"video/*"},on:{change:function(e){return t.fileFollowVideo(e)}}}),e("div",{directives:[{name:"show",rawName:"v-show",value:!1,expression:"false"}],staticClass:"audiobox"},[e("input",{staticClass:"uploadAudio",attrs:{type:"file",name:"audio",id:"audio",accept:"audio/*"},on:{change:t.uploadAudio}})]),e("div",{staticClass:"d-flex justify-content-end",staticStyle:{"margin-top":"20px"}},[e("button",{staticClass:"common-submitBtn",attrs:{title:"回复"},on:{click:t.sendCommentTo}},[t._v("回复")])])],1),e("div",{directives:[{name:"show",rawName:"v-show",value:t.atsListShow,expression:"atsListShow"}],staticClass:"el-popover el-popper friend_box",staticStyle:{width:"200px","transform-origin":"center top","z-index":"2021",position:"absolute",top:"30px",left:"16px",padding:"0 !important"},attrs:{role:"tooltip","aria-hidden":"false",tabindex:"0","x-placement":"bottom"}},[t._m(0),e("div",{staticClass:"auto-friend-list"},[e("ul",[t._l(t.getFriendList||[],(function(i,s){return e("li",{key:s,staticClass:"on c-pointer",on:{click:function(e){return t.selectUser(i)}}},[e("a",{attrs:{href:"javascript:void(0);"}},[t._v(t._s(i.nickname||""))])])})),0===t.getFriendList.length?e("div",{staticClass:"noData"},[t._v("您还未添加好友")]):t._e()],2)]),e("p",{staticClass:"auto-direction"},[t._v("@用户名  就可以通知他")]),e("div",{staticClass:"popper__arrow",staticStyle:{left:"20px"}})]),t.uploadCreated?e("my-upload",{ref:"myupload",on:{addContent:t.addContent}}):t._e()],1)},N=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"auto-friend-search"},[e("input",{staticClass:"auto-search",attrs:{type:"text",value:"",bindcursor:"true"}}),e("input",{staticClass:"auto-button",attrs:{type:"button"}})])}],A=(i("06f1"),i("6ac9")),E=i.n(A),D=(i("560b"),i("dcdc")),P=i.n(D),M=(i("1951"),i("eedf")),B=i.n(M),q=(i("a753"),i("8096"),i("14e1"),i("0fb7"),i("f529")),V=i.n(q),z=i("7f0b"),F=i("29ad"),R=i("2f62"),U={data(){return{localFile:!1,data:{},layer_height:0,timer:null,process:0,showHidden:!1,loading:!1,disabled:!1,fileList:[],atsListShow:!1,getFriendList:[],sendFriendList:[],loadNum:0}},methods:{...Object(R["d"])({updateVideoData:"updateVideoData"}),selectEmoji(t){try{let i,s=this.$refs.myQuillEditor.quill;try{i=s.selection.savedRange.index}catch(e){i=0}s.insertEmbed(i,"image",{url:t.url,id:t.id,emoji:!0}),s.setSelection(i+1)}catch(e){}},pickClick(){f["a"].isLogon()?(this.uploadCreated=!0,this.$nextTick(()=>{this.$refs.myupload.dialogTableVisible=!0})):this.$loginWindow({reload:!0})},async fileFollowImg(t){const e=t.target.files[0],i=t.target.files,{bool:s,message:a}=Object(z["b"])(e);if(!s)return this.$message.error(a),void(this.$refs.file&&this.$refs.file.value&&""!==this.$refs.file.value&&(this.$refs.file.value=""));this.spinning=!0;try{for(let t in i){if(1*i[t]==i[t])return;const e=new FormData;e.append("entity_id",""),e.append("entity_type","topic"),e.append("image",i[t],i[t].name);const s={headers:{"Content-Type":"multipart/form-data"}},a=await n["C"].call(this,e,s,t=>{this.loadNum=t}),{data:o}=a;if(!o)return void(this.spinning=!1);let r=new FileReader;r.readAsDataURL(i[t]),r.onload=async t=>{o.url=r.result,await this.handleUpload(o,"img"),this.spinning=!1}}}catch(t){this.spinning=!1}finally{this.$refs.file.value&&""!==this.$refs.file.value&&(this.$refs.file.value="")}},async fileFollowVideo(t){const e=t.target.files[0],{bool:i,message:s}=Object(z["c"])(e);if(!i)return this.$message.error(s),void(this.$refs.fileVideo&&this.$refs.fileVideo.value&&""!==this.$refs.fileVideo.value&&(this.$refs.fileVideo.value=""));this.spinning=!0;try{const t=new FormData;t.append("entity_id",""),t.append("entity_type","topic"),t.append("image",e,e.name);const i={headers:{"Content-Type":"multipart/form-data"}},s=await n["C"].call(this,t,i,t=>{this.loadNum=t}),{data:a}=s;await this.handleUpload(a,"video"),this.spinning=!1}catch(t){this.spinning=!1}finally{this.$refs.fileVideo&&this.$refs.fileVideo.value&&""!==this.$refs.fileVideo.value&&(this.$refs.fileVideo.value="")}},async handleUpload(t,e){this.fileList.push(t),this.fileList[this.fileList.length-1].id=t.id,"images"===e?this.appendChildImg(t):"video"===e?this.appendChildVideo(t):"audio"===e?this.appendAudio(t):this.appendLink(t)},appendLink(t){let e,i=this.$refs.myQuillEditor.quill;e=i.getSelection()&&i.getSelection().index||0,i.insertEmbed(e,"link",{url:t.remoteUrl,name:t.name,id:t.id},"api"),i.setSelection(e+1)},appendAudio(t){let e,i=this.$refs.myQuillEditor.quill;e=i.getSelection()&&i.getSelection().index||0,i.insertEmbed(e,"audio",{url:t.remoteUrl,id:t.id},"api"),i.setSelection(e+1)},appendChildImg(t){let e,i=this.$refs.myQuillEditor.quill;try{e=i.selection.savedRange.index}catch(s){e=0}i.insertEmbed(e,"image",{url:t.url,id:t.id}),i.setSelection(e+1)},appendChildVideo(t){try{let i,s=this.$refs.myQuillEditor.quill;try{i=s.selection.savedRange.index}catch(e){i=0}s.insertEmbed(i,"image",{url:"/images/common/videos2x.png",id:t.id,video:t.remoteUrl}),s.setSelection(i+1),this.$nextTick(()=>{var e=this;let i=document.querySelector('[data-id="'+t.id+'"]');i.onclick=function(){e.updateVideoData({show:!0,url:t.remoteUrl,id:t.id,name:t.name?t.name:"视频_"+t.id})}})}catch(i){}},auidoClick(){document.querySelector("#audio").click()},async uploadAudio(){let t=document.querySelector("#audio").files[0];if(-1==t.type.indexOf("audio/"))return void this.$toast("请选择音频文件");const{bool:e,message:i}=Object(z["a"])(t);if(!e)return this.$message.error(i),void(this.$refs.file&&this.$refs.file.value&&""!==this.$refs.file.value&&(this.$refs.file.value=""));this.spinning=!0;try{const e=new FormData;e.append("entity_id",""),e.append("entity_type","topic"),e.append("image",t,t.name);const i={headers:{"Content-Type":"multipart/form-data"}},s=await n["C"].call(this,e,i,t=>{this.loadNum=t}),{data:a}=s;let o,r=this.$refs.myQuillEditor.quill;o=r.getSelection()&&r.getSelection().index||0,r.insertEmbed(o,"audio",{url:a.remoteUrl,id:a.id},"api"),r.setSelection(o+1),this.spinning=!1}catch(s){this.spinning=!1}finally{this.$refs.fileVideo&&this.$refs.fileVideo.value&&""!==this.$refs.fileVideo.value&&(this.$refs.fileVideo.value="")}},videoClick(){if(f["a"].isLogon())try{document.querySelector(".uploadVideo").click()}catch(t){}else this.$loginWindow({reload:!0})},async showAts(){if(!f["a"].get(f["a"].NOTLOGIN)&&f["a"].get(f["a"].TOKEN)){this.atsListShow=!this.atsListShow;try{const t=await n["k"].call(this);this.getFriendList=t.data||[]}catch(t){}}else this.$loginWindow({reload:!0})},selectUser(t){if(f["a"].isLogon()){try{var e=this.$refs.myQuillEditor.quill;let i=0;this.sendFriendList.push(t),"@"==e.getText()[e.getText().length-2]?e.insertText(e.selection.savedRange.index,t.nickname,"",!0):e.insertText(e.selection.savedRange.index,"@"+t.nickname,"",!0);let s,a=e.getSelection();s=a&&a.index?a.index:0,e.setSelection(s+i,1)}catch(i){}this.atsListShow=!1}else this.$loginWindow({reload:!0})},async sendCommentTo(){if(!f["a"].isLogon())return void this.$loginWindow({reload:!0});if(this.loading&&this.disabled)return;this.loading=!this.loading,this.disabled=!this.disabled;let t=this.content;if(!t||"<p></p>"==t.replace(/\s/g,""))return this.disabled=!1,void this.$message.error("请输入回复内容");let e=[];for(let n=0;n<this.sendFriendList.length;n++)e.push(this.sendFriendList[n].userId),t=t.replace(new RegExp("@"+this.sendFriendList[n].nickname),`<span data-uid="${this.sendFriendList[n].userId}"  class="at-box">@${this.sendFriendList[n].nickname} </span>`);let i=[];this.fileList.length>0&&this.fileList.forEach((t,e)=>{-1!=this.content.indexOf(t.url)&&i.push(t.id)});let s=document.querySelectorAll(".ql-editor #showaudio");s&&s.length>0&&s.forEach((function(e){let i=e.getAttribute("data-id"),s=e.getAttribute("src");t=t.replace(`<audio src="${s}" controls="true" controlslist="nodownload" id="showaudio" data-id="${i}"></audio>`,`<audio src="haijiao.com" controls="true" controlslist="nodownload" id="showaudio" data-id="${i}"></audio>`)}));const{pid:a}=this.$route.query;let o=t.split('<img src="');o.forEach(e=>{if(-1!=e.indexOf("data:image/")){let i=e.split('"')[0],s=1024e3,a=Math.ceil(i.length/10240);for(let e=0;e<a;e++){let a=i.slice(e*s,(e+1)*s);a&&(t=t.replace(a,""))}}}),t=Object(k["b"])(t);let r=Object(F["c"])(t),l=V()({type:"warning",message:"正在发送请稍后...",duration:0});try{const t={topic_id:Number(a),reply_id:0,content:r,attachment_ids:i,ats:e,is_sale:this.checked,sale_price:this.checked?1==this.topicDetails.sale.money_type?1*this.floorMoney:100*this.floorMoney:0},s=await n["x"].call(this,t);l.close(),s.data&&s.data.reply_id?this.$message.success("回复成功，请稍后"):this.$message.success("回复成功，审核中！"),this.checked=!1,this.floorMoney=null,this.sendFriendList=[],this.getFriendList=[],this.fileList=[],this.atsListShow=!1,this.content=""}catch(c){l.close(),this.$message.error(c)}finally{this.loading=!this.loading,this.disabled=!this.disabled}}}},Q=i("9297"),W=i("953d"),H=i("decf");const Y=[];var K={props:{topicDetails:{type:Object,default:null}},data(){return{uploadCreated:!1,spinning:!1,floorMoney:null,isClient:!1,checked:!1,content:"",uid:0,showEmoji:!1,editorOption:{placeholder:"请输入内容",modules:{toolbar:{container:Y,handlers:{image:function(t){t&&document.querySelector(".van-uploader__input").click()},video:function(t){t&&document.querySelector(".uploadVideo").click()}}}}}}},mixins:[U],mounted(){this.uid=f["a"].get(f["a"].ID)},methods:{addContent(t){t.forEach(t=>{-1!=this.content.indexOf("<video")&&"video"===t.category?this.$message.error("只能插入一个视频"):this.handleUpload(t,t.category)})},navigatorTo(){f["a"].isLogon()?this.$router.push("/post/drafts"):this.$loginWindow({reload:!0})},setSell(){let t=this.$refs.myQuillEditor.quill.selection.savedRange.index;t?this.$refs.myQuillEditor.quill.insertText(t,"[sell] [/sell]"):this.content+="[sell] [/sell]"},onEditorBlur(t){},onEditorFocus(t){},onEditorReady(t){},onEditorChange({editor:t,html:e,text:i}){},clear(){this.content="",this.amount="",this.reward_hours="",this.type=0,this.money_type=0}},components:{quillEditor:W["quillEditor"],ElButton:B.a,ElCheckbox:P.a,ElPopover:E.a,emoji:Q["a"],MyUpload:H["a"]}},G=K,J=(i("15e2"),i("3fbe"),Object(h["a"])(G,O,N,!1,null,"333245aa",null)),X=J.exports,Z=i("6c74"),tt=function(){var t=this,e=t._self._c;return t.isinit?e("div",{staticClass:"hj-rankinglist"},[e("div",{staticClass:"hj-title"},[t._v("打赏排行榜")]),e("div",{staticClass:"navigation"},t._l(t.navigation,(function(i){return e("div",{key:i.value,staticClass:"textBtn",class:{choose:i.value==t.choosenavigation},on:{click:function(e){t.choosenavigation=i.value}}},[t._v(" "+t._s(i.label)+" ")])})),0),e("div",{staticClass:"hj-bodyContainer"},[t.arraylist.length?t._l(t.arraylist,(function(i,s){return e("div",{key:i.id,staticClass:"layout",on:{click:function(e){return t.userdetails(i)}}},[e("user-avatar",{attrs:{src:i.avatar,size:"40px",avatarbg:i.title?i.title.icon:"",showVip:!0,vipLevel:i.vip,certified:i.certified,origin:i.certVideo,expert:i.certProfessor,showFamous:i.famous}}),e("div",{staticClass:"nickname",class:["icon"+(s+1)]},[t._v(t._s(i.nickname))])],1)})):[e("div",{staticClass:"layout",on:{click:function(e){return t.$emit("exceptional")}}},[e("div",{staticClass:"emptyuser"}),e("div",{staticClass:"nickname emptys"},[t._v("打赏礼物")])])]],2),e("div",{staticClass:"statisticalContainer"},[e("div",{staticClass:"statistical",on:{click:function(e){t.$refs.rankingdialog&&t.$refs.rankingdialog.onshow()}}},[t._v(" 共"),e("span",[t._v(t._s(t.total))]),t._v("人打赏礼物"),e("i",{staticClass:"el-icon-arrow-right"})])]),e("ranking-list-dialog",{ref:"rankingdialog",attrs:{newchoose:t.choosenavigation,diamondList:t.diamondlist,goldList:t.goldlist}})],1):t._e()},et=[],it=function(){var t=this,e=t._self._c;return t.show?e("el-dialog",{attrs:{top:"10vh","show-close":!1,visible:t.show,"modal-append-to-body":!1,width:"550px","custom-class":"hj-dialog-custom"},on:{"update:visible":function(e){t.show=e}}},[e("template",{slot:"title"},[e("div",{staticClass:"rankingd-giftListHeader"},[t._l(t.navigation,(function(i){return e("div",{key:i.value,staticClass:"rankingd-textBtn",class:{"rankingd-choose":i.value==t.choosenavigation},on:{click:function(e){t.choosenavigation=i.value}}},[t._v(" "+t._s(i.label)+" ")])})),e("div",{staticClass:"rankingd-iconclose",on:{click:function(e){e.stopPropagation(),t.show=!1}}},[e("i",{staticClass:"el-icon-close"})])],2)]),e("div",{staticClass:"rankingd-rowContainer"},[t.arraylist.length?[t.showMef&&t.showMef.id?e("div",{staticClass:"rankingd-layout rankingd-mylocation"},[e("div",{staticClass:"rankingd-leftContainer"},[e("div",[t._v("我的排名：")]),t.showMef.rank?[1==t.showMef.rank||2==t.showMef.rank||3==t.showMef.rank?[e("div",{staticClass:"rankingd-ranking firstthree"},[e("img",{attrs:{src:"/images/common/ranking1.png",alt:""}})])]:[e("div",{staticClass:"ranking haslist"},[t._v(t._s(t.showMef.rank))])]]:[e("div",{staticClass:"ranking notlist"},[t._v("未上榜")])]],2),e("div",{staticClass:"rankingd-middleContainer",on:{click:function(e){return t.userdetails(t.showMef)}}},[e("user-avatar",{attrs:{avatabg:t.showMef.title?t.showMef.title.icon:"",size:"30px",id:"",src:t.showMef.avatar,showVip:!0,vipLevel:t.showMef.vip,certified:t.showMef.certified,origin:t.showMef.certVideo,expert:t.showMef.certProfessor,showFamous:t.showMef.famous}}),e("div",{staticClass:"rankingd-nickname"},[t._v(t._s(t.showMef.nickname))])],1),e("div",{staticClass:"rankingd-rightContainer"},[e("div",{staticClass:"rankingd-myicon",class:{gold:1==t.choosenavigation,diamond:2==t.choosenavigation}},[2==t.choosenavigation?[t._v(t._s(t._f("showNumber")(t.showMef.score/100)))]:[t._v(t._s(t._f("showNumber")(t.showMef.score)))]],2)])]):t._e(),e("div",{staticClass:"rankingd-layout rankingd-tableheader"},[e("div",{staticClass:"rankingd-leftContainer"},[t._v("排名")]),e("div",{staticClass:"rankingd-middleContainer"},[t._v("姓名")]),e("div",{staticClass:"rankingd-rightContainer"},[t._v("打赏数量")])]),t._l(t.arraylist,(function(i,s){return e("div",{key:i.id,staticClass:"rankingd-layout rankingd-tablelist"},[e("div",{staticClass:"rankingd-leftContainer"},[0==s?[e("img",{staticClass:"rankingd-place",attrs:{src:"/images/common/ranking1.png",alt:"第一名"}})]:1==s?[e("img",{staticClass:"rankingd-place",attrs:{src:"/images/common/ranking2.png",alt:"第二名"}})]:2==s?[e("img",{staticClass:"rankingd-place",attrs:{src:"/images/common/ranking3.png",alt:"第三名"}})]:[e("div",{staticClass:"rankingd-xuhao"},[t._v(t._s(s+1))])]],2),e("div",{staticClass:"rankingd-middleContainer",on:{click:function(e){return t.userdetails(i)}}},[e("user-avatar",{attrs:{avatarbg:i.title?i.title.icon:"",src:i.avatar,showVip:!0,vipLevel:i.vip,certified:i.certified,origin:i.certVideo,expert:i.certProfessor,showFamous:i.famous,size:"30px"}}),e("div",{staticClass:"rankingd-nickname"},[t._v(t._s(i.nickname))])],1),e("div",{staticClass:"rankingd-rightContainer"},[e("div",{staticClass:"rankingd-myicon diamond",class:{gold:1==t.choosenavigation,diamond:2==t.choosenavigation}},[2==t.choosenavigation?[t._v(t._s(t._f("showNumber")(t.newscore(i.score))))]:[t._v(t._s(t._f("showNumber")(i.score)))]],2)])])}))]:[e("div",{staticClass:"rankingd-emptylist"},[t._v("暂无可用的榜单")])]],2)],2):t._e()},st=[],at=i("4733"),ot=i("7d1a");const nt={value:2,label:"钻石礼物榜"},rt={value:1,label:"金币礼物榜"};var lt={components:{dialogHeader:ot["a"]},data(){return{navigation:[nt,rt],choosenavigation:nt.value,choose:null,show:!1}},props:{defaultchoose:{type:Number,default:1},newchoose:{type:Number,default:nt.value},diamondList:{type:Array,default:()=>[]},goldList:{type:Array,default:()=>[]}},computed:{...Object(R["c"])({userInfo:"userInfo"}),showMef:function(){let t=[];const e=this.choosenavigation;e==nt.value?t=this.diamondList:e==rt.value&&(t=this.goldList);let i=null;for(let s of t)s.id==this.$store.state.userInfo.id&&(i=s);return i},arraylist(){const t=this.choosenavigation;let e=[];return t==nt.value?e=this.diamondList:t==rt.value&&(e=this.goldList),e.length&&(e=e.filter((function(t){return t.rank}))),e},mylocation(){const t=this.userInfo;return t&&t.hasOwnProperty("id")?t:{}}},methods:{...Object(R["b"])(["asyncBackpackList"]),newscore(t=0){return t?Object(at["a"])(t,100):0},userdetails(t){const e=this.$store.state;e.isLogin?this.$router.push({name:"homepage_index",params:{uid:t.id}}):this.$confirm("您未登录，是否前往登录？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$router.push("/login")}).catch(()=>{})},onshow(){this.diamondList.length||(this.navigation=[rt]),this.choosenavigation=this.newchoose,this.show=!0}}},ct=lt,dt=(i("a7ac"),Object(h["a"])(ct,it,st,!1,null,"41d7dc8b",null)),ht=dt.exports;const ut=[{value:2,label:"钻石礼物榜"},{value:1,label:"金币礼物榜"}];var pt={components:{rankingListDialog:ht},data(){return{isinit:0,navigation:ut,choosenavigation:ut[0].value,diamondtotal:0,diamondlist:[],goldtotal:0,goldlist:[],show:!1}},props:{topicId:{type:Number,default:460}},computed:{total(){const t=this.choosenavigation;return t==ut[0].value?this.diamondtotal:t==ut[1].value?this.goldtotal:0},arraylist(){const t=this.choosenavigation;let e=[];return t==ut[0].value?e=this.diamondlist:t==ut[1].value&&(e=this.goldlist),e&&e.length&&(e=e.filter((function(t){return t.rank}))),e||[]}},created(){this.$nextTick(()=>{this.oninit()})},methods:{userdetails(t){const e=this.$store.state;e.isLogin?this.$router.push({name:"homepage_index",params:{uid:t.id}}):this.$confirm("您未登录，是否前往登录？","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(()=>{this.$router.push("/login")}).catch(()=>{})},async oninit(){try{const t=this.topicId,e=await Object(n["l"])({moneyType:1,sourceId:t,sourceType:1}),i=await Object(n["l"])({moneyType:2,sourceId:t,sourceType:1});(e.data.total||i.data.total)&&(i.data.total?(this.diamondtotal=i.data.total,this.diamondlist=i.data.list):(this.navigation=[ut[1]],this.choosenavigation=ut[1].value),e.data.total&&(this.goldtotal=e.data.total,this.goldlist=e.data.list),this.isinit=1)}catch(t){}}}},mt=pt,gt=(i("eb38"),Object(h["a"])(mt,tt,et,!1,null,"2b7f3093",null)),ft=gt.exports,vt=i("81ee");n["c"],n["a"];var yt={async mounted(){},methods:{async handleLink(){const t=this.$route.query.pid;if(t&&""!==t){if(!f["a"].isLogon())return void this.$loginWindow({reload:!0});try{const e=new FormData;e.append("status",""+!this.likeState);const i={headers:{"Content-Type":"multipart/form-data"}};await n["d"].call(this,t,e,i);this.likeState=!this.likeState,this.likeState?this.$message.success("点赞成功！"):this.$message.success("取消点赞成功！"),this.likeState?this.articleInfo.likeCount++:this.articleInfo.likeCount>=1?this.articleInfo.likeCount--:this.articleInfo.likeCount=0}catch(e){}}},async buySale(t){let e=t.articleInfo,i=t.type,s=t.floor;const a=this;if(0==i&&1==e.type&&!1===e.sale.is_buy)try{const i=new FormData;i.append("topic_id",""+e.topicId),i.append("reply_id",0),i.append("discount_id",t.discount);const s={headers:{"Content-Type":"multipart/form-data"}};await n["y"].call(a,i,s),this.$message.success("购买成功！"),e.sale.is_buy=!0,a.$axios.get(b["a"]+"/topic/"+e.topicId).then(t=>{a.articleInfo.content=t.data.content,a.$nextTick(()=>{setTimeout(()=>{a._processVideo()},300)}),a.updateTopic=!1,setTimeout(()=>{a.updateTopic=!0},100),setTimeout(()=>{window.location.reload()},100)}).catch(t=>{})}catch(o){this.$message.error(o)}else if(1==i&&1==e.type)try{const i=new FormData;i.append("topic_id",e.topicId),i.append("reply_id",s.reply_id),i.append("discount_id",t.discount);const o={headers:{"Content-Type":"multipart/form-data"}};await n["y"].call(a,i,o),this.$message.success("购买成功！"),a.$axios.get(b["a"]+`/comment/reply_list?page=1&topic_id=${e.topicId}&search_type=0`).then(t=>{function e(t){t.data&&t.data.results&&Array.isArray(t.data.results)&&(t.data.results=t.data.results.map(t=>(t.comment_list={lastPage:!1,page:0,list:[]},t.textareaObj={visibleTextarea:!1,quote:{},textareaContent:"",placeholder:""},t)))}e(t),a.$set(a,"commentList",t.data),a.updateContent=!1,setTimeout(()=>{a.updateContent=!0,a.$nextTick(()=>{setTimeout(()=>{a._processVideo()},300)})},100)}).catch(t=>{})}catch(o){this.$message.error(o)}},async handleBuy(t,e,i){f["a"].isLogon()?(this.sellMoney=i?i.price:t.sale.amount,this.isShowDisCard=!0,this.$nextTick(()=>{this.$refs.dicountCard.dialogVisible=!0,this.$refs.dicountCard.articleInfo=t,this.$refs.dicountCard.type=e,this.$refs.dicountCard.floor=i})):this.$loginWindow({reload:!0})},async handleSubscribe(t){if(t.is_subscribe)return!1;if(!f["a"].isLogon())return void this.$loginWindow({reload:!0});let e=f["a"].get(f["a"].ID);t.user.id!=e?3==t.type&&t.topicId&&Object(vt["d"])("subscribe").then(e=>{const{freeNum:i,goodsNum:s}=e.data;0==i&&0==s?this._onsubscribe(!1):this._onsubscribe(!0,{topic_id:t.topicId})}).catch(()=>{}):this.$message.error("无法订阅自己发布的贴子")},_onsubscribe(t=!1,e={}){const i=this;t?this.$hjConfirm("将消耗一次订阅次数，是否确定？",{async onOk(){try{await n["z"].call(i,e),i.articleInfo.is_subscribe=!0,i.$message.success("订阅成功!")}catch(t){i.$message.error(t)}}}):this.$hjConfirm("你的订阅卡数量不足，请前往商城购买",{async onOk(){try{window.open(window.location.origin+"/mall/diamond")}catch(t){this.$message.error(t)}}})}}},bt={data(){return{myVideo:null,timer:null}},mounted(){},destroyed(){this.timer&&clearTimeout(this.timer)},methods:{_processVideo(){try{const t=document.querySelectorAll("video");console.log(t);for(let e=0;e<t.length;e++){if(""!==t[e].id)continue;if(-1!=t[e].getAttribute("src").indexOf(".mp4")){this.$message.error("视频格式错误请联系管理员");continue}let i=t[e].getAttribute("class");i&&-1!==i.indexOf("video-js vjs-default-skin vjs-big-play-centered")||(t[e].className+=" video-js vjs-default-skin vjs-big-play-centered"),t[e].id="myVideo_"+e+1,document.querySelector("#"+t[e].id).setAttribute("style","width:90%;margin:auto;height:500px");let s=videojs(t[e].id,{bigPlayButton:!0,textTrackDisplay:!1,posterImage:!1,errorDisplay:!1,hls:{withCredentials:!0},controlBar:{fullscreenToggle:!0}});s.src({src:t[e].src,type:"application/x-mpegURL"}),s.on("loadeddata",(function(t){t.target.classList.remove("vjs-controls-disabled")}))}}catch(t){}}}},_t=i("894b"),wt=i("d1eb");async function Ct(t,e){return Object(wt["b"])(t,e.nodeId)}async function xt(t){const e=await Object(n["h"])(t),i=e.data||{};return i.content=Object(F["a"])(i.content),i.content=i.content.replace(/id="myVideo_(\S*)"/gi,""),i}async function kt(t){let e=!1,i={page:{limit:20,page:0,total:0},results:[]};try{const s=await Object(n["j"])(t);It(s),s.data.results||(e=!0),s.data.results&&s.data.results.length>0&&s.data.results.forEach(t=>{t.content=Object(F["a"])(t.content)}),i=s.data}catch(s){e=!0}return{commentLastPage:e,data:i}}async function Lt(t){const{topic_id:e}=t;let i=!1;if(e&&""!==e)try{const t=await Object(n["i"])({entityId:e,entityType:"topic"});i=t.data.like||!1}catch(s){}return i}function It(t){t.data&&t.data.results&&Array.isArray(t.data.results)&&(t.data.results=t.data.results.map(t=>(t.comment_list={lastPage:!1,page:0,list:[]},t.textareaObj={visibleTextarea:!1,quote:{},textareaContent:"",placeholder:""},t)))}var Tt=function(){var t=this,e=t._self._c;return e("el-dialog",{attrs:{title:"购买提示",visible:t.dialogVisible,"custom-class":"discount-card","before-close":t.handleClose},on:{"update:visible":function(e){t.dialogVisible=e}}},[e("div",{staticClass:"card-body"},[e("div",{staticClass:"nowmoney"},[t._v("确认支付"+t._s(t.numMoney)+t._s(t._f("showMoney")(t.moneyType)))]),e("div",{staticClass:"oldmoney"},[t._v("原价"+t._s(t.MoneyShow(t.sellMoney,t.moneyType))+t._s(t._f("showMoney")(t.moneyType)))]),e("ul",{staticClass:"list"},[e("li",{class:{active:0==t.radio},on:{click:function(e){t.radio=0}}},[e("span",[t._v("不使用打折卡")]),e("el-radio",{attrs:{label:0},on:{click:function(t){t.stopPropagation()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}})],1),t._l(t.list,(function(i,s){return e("li",{key:s,class:{disboled:0==i.num,active:i.id==t.radio},on:{click:function(e){return t.select(i)}}},[e("div",[e("img",{attrs:{src:i.icon,alt:""}}),e("div",[t._v(t._s(i.name)+"卡")])]),e("span",[e("span",[t._v(t._s(i.name)+"优惠购买")]),e("span",{staticStyle:{"font-size":"12px",color:"#999","margin-left":"10px"}},[t._v("剩余"+t._s(i.num)+"张")])]),e("el-radio",{attrs:{label:i.id},on:{click:function(t){t.stopPropagation()}},model:{value:t.radio,callback:function(e){t.radio=e},expression:"radio"}})],1)}))],2),e("div",{staticClass:"tomall",on:{click:function(e){return t.$router.push("/mall/diamond")}}},[t._v("前往商城购买打折卡")])]),e("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[e("el-button",{on:{click:t.close}},[t._v("取 消")]),e("el-button",{attrs:{type:"primary"},on:{click:t.okbtn}},[t._v("确 定")])],1)])},St=[],$t=i("1f24"),jt={name:"discuntCard",components:{},props:{sellMoney:{type:Number,default:0},moneyType:{type:Number,default:1}},data(){return{list:[{name:"九折",num:2,id:301,icon:""},{name:"八折",num:1,id:302,icon:""},{name:"七折",num:2,id:303,icon:""}],radio:0,articleInfo:null,type:0,floor:null,dialogVisible:!1}},filters:{showMoney:function(t){return 1==t?"金币":2==t?"钻石":"未知"}},computed:{numMoney(){return 301==this.radio?1==this.moneyType?Math.ceil(.9*this.sellMoney):(Math.ceil(.9*this.sellMoney)/100).toFixed(2):302==this.radio?1==this.moneyType?Math.ceil(.8*this.sellMoney):(Math.ceil(.8*this.sellMoney)/100).toFixed(2):303==this.radio?1==this.moneyType?Math.ceil(.7*this.sellMoney):(Math.ceil(.7*this.sellMoney)/100).toFixed(2):1==this.moneyType?Math.ceil(this.sellMoney):(Math.ceil(this.sellMoney)/100).toFixed(2)}},watch:{},methods:{close(){this.dialogVisible=!1,this.$emit("close")},okbtn(){this.dialogVisible=!1,this.$emit("puySale",{articleInfo:this.articleInfo,type:this.type,floor:this.floor,discount:this.radio,userMoney:this.numMoney})},select(t){t.num>0&&(this.radio=t.id)},handleClose(){},getList(){Object($t["s"])().then(t=>{this.list[0].icon=t.data["301_img"],this.list[1].icon=t.data["302_img"],this.list[2].icon=t.data["303_img"],this.list[0].num=t.data["301"],this.list[1].num=t.data["302"],this.list[2].num=t.data["303"],0!=t.data["301"]?this.radio=301:0!=t.data["302"]?this.radio=302:0!=t.data["303"]?this.radio=303:this.radio=0}).catch()}},created(){this.getList()},mounted(){},beforeCreate(){},beforeMount(){},beforeUpdate(){},updated(){},beforeDestroy(){},destroyed(){},activated(){}},Ot=jt,Nt=(i("2848"),Object(h["a"])(Ot,Tt,St,!1,null,null,null)),At=Nt.exports,Et=i("ba8a"),Dt=i("c10a"),Pt=function(){var t=this,e=t._self._c;return e("div",{directives:[{name:"show",rawName:"v-show",value:t.showPrompt,expression:"showPrompt"}],staticClass:"pagecontainer"},[e("div",{staticClass:"vipbtn",on:{click:t.onOpen}},[t._v("升级VIP"+t._s(t.vipLimit)+"查看完整内容")]),t._m(0)])},Mt=[function(){var t=this,e=t._self._c;return e("div",{staticClass:"containers"},[e("div",{staticClass:"headertitle"},[t._v("开通VIP会员，尊享10大权益")]),e("div",{staticClass:"rowlist"},[e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon1"}),e("div",{staticClass:"tiles"},[t._v("更多提款次数")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon2"}),e("div",{staticClass:"tiles"},[t._v("身份标识")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon3"}),e("div",{staticClass:"tiles"},[t._v("更多免费私信")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon4"}),e("div",{staticClass:"tiles"},[t._v("VIP板块")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon5"}),e("div",{staticClass:"tiles"},[t._v("更多免费订阅")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon6"}),e("div",{staticClass:"tiles"},[t._v("VIP专属表情")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon7"}),e("div",{staticClass:"tiles"},[t._v("出售赚钻石")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon8"}),e("div",{staticClass:"tiles"},[t._v("出售赚金币")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon9"}),e("div",{staticClass:"tiles"},[t._v("充值赠送")])]),e("div",{staticClass:"itemlist"},[e("div",{staticClass:"circle privilege_icon10"}),e("div",{staticClass:"tiles"},[t._v("给好友转账")])])])])}],Bt={props:{vipLimit:{type:Number,default:0}},computed:{showPrompt(){const t=this.vipLimit,e=this.$store.state;if(e.isLogin){const i=e.userInfo.vip;return!(i>=t||1==e.userInfo.role)}return 0!=t}},methods:{onOpen(){const t=this.$store.state;t.isLogin?this.$router.push({name:"member"}):this.$loginWindow()}}},qt=Bt,Vt=(i("11cb"),Object(h["a"])(qt,Pt,Mt,!1,null,"ebdf6f1a",null)),zt=Vt.exports,Ft=(i("91ae"),function(){var t=this,e=t._self._c;return e("transition",{attrs:{name:"viewer-fade"}},[e("div",{ref:"el-image-viewer__wrapper",staticClass:"el-image-viewer__wrapper",style:{"z-index":t.viewerZIndex},attrs:{tabindex:"-1"}},[e("div",{staticClass:"el-image-viewer__mask",on:{click:function(e){return e.target!==e.currentTarget?null:t.handleMaskClick.apply(null,arguments)}}}),e("span",{staticClass:"el-image-viewer__btn el-image-viewer__close",on:{click:t.hide}},[e("i",{staticClass:"el-icon-close"})]),t.isSingle?t._e():[e("span",{staticClass:"el-image-viewer__btn el-image-viewer__prev",class:{"is-disabled":!t.infinite&&t.isFirst},on:{click:t.prev}},[e("i",{staticClass:"el-icon-arrow-left"})]),e("span",{staticClass:"el-image-viewer__btn el-image-viewer__next",class:{"is-disabled":!t.infinite&&t.isLast},on:{click:t.next}},[e("i",{staticClass:"el-icon-arrow-right"})])],e("div",{staticClass:"el-image-viewer__btn el-image-viewer__actions"},[e("div",{staticClass:"el-image-viewer__actions__inner"},[e("i",{staticClass:"el-icon-zoom-out",on:{click:function(e){return t.handleActions("zoomOut")}}}),e("i",{staticClass:"el-icon-zoom-in",on:{click:function(e){return t.handleActions("zoomIn")}}}),e("i",{staticClass:"el-image-viewer__actions__divider"}),e("i",{class:t.mode.icon,on:{click:t.toggleMode}}),e("i",{staticClass:"el-image-viewer__actions__divider"}),e("i",{staticClass:"el-icon-refresh-left",on:{click:function(e){return t.handleActions("anticlocelise")}}}),e("i",{staticClass:"el-icon-refresh-right",on:{click:function(e){return t.handleActions("clocelise")}}})])]),e("div",{staticClass:"el-image-viewer__canvas"},t._l(t.urlList,(function(i,s){return s===t.index?e("img",{key:i,ref:"img",refInFor:!0,staticClass:"el-image-viewer__img",style:t.imgStyle,attrs:{src:t.currentImg},on:{load:t.handleImgLoad,error:t.handleImgError,mousedown:t.handleMouseDown}}):t._e()})),0)],2)])}),Rt=[],Ut=i("2b0e");const Qt=Ut["default"].prototype.$isServer,Wt=/([\:\-\_]+(.))/g,Ht=/^moz([A-Z])/,Yt=Qt?0:Number(document.documentMode),Kt=function(t){return(t||"").replace(/^[\s\uFEFF]+|[\s\uFEFF]+$/g,"")},Gt=function(t){return t.replace(Wt,(function(t,e,i,s){return s?i.toUpperCase():i})).replace(Ht,"Moz$1")},Jt=function(){return!Qt&&document.addEventListener?function(t,e,i){t&&e&&i&&t.addEventListener(e,i,!1)}:function(t,e,i){t&&e&&i&&t.attachEvent("on"+e,i)}}(),Xt=function(){return!Qt&&document.removeEventListener?function(t,e,i){t&&e&&t.removeEventListener(e,i,!1)}:function(t,e,i){t&&e&&t.detachEvent("on"+e,i)}}();function Zt(t,e){if(!t||!e)return!1;if(-1!==e.indexOf(" "))throw new Error("className should not contain space.");return t.classList?t.classList.contains(e):(" "+t.className+" ").indexOf(" "+e+" ")>-1}function te(t,e){if(t){for(var i=t.className,s=(e||"").split(" "),a=0,o=s.length;a<o;a++){var n=s[a];n&&(t.classList?t.classList.add(n):Zt(t,n)||(i+=" "+n))}t.classList||t.setAttribute("class",i)}}function ee(t,e){if(t&&e){for(var i=e.split(" "),s=" "+t.className+" ",a=0,o=i.length;a<o;a++){var n=i[a];n&&(t.classList?t.classList.remove(n):Zt(t,n)&&(s=s.replace(" "+n+" "," ")))}t.classList||t.setAttribute("class",Kt(s))}}const ie=Yt<9?function(t,e){if(!Qt){if(!t||!e)return null;e=Gt(e),"float"===e&&(e="styleFloat");try{switch(e){case"opacity":try{return t.filters.item("alpha").opacity/100}catch(i){return 1}default:return t.style[e]||t.currentStyle?t.currentStyle[e]:null}}catch(i){return t.style[e]}}}:function(t,e){if(!Qt){if(!t||!e)return null;e=Gt(e),"float"===e&&(e="cssFloat");try{var i=document.defaultView.getComputedStyle(t,"");return t.style[e]||i?i[e]:null}catch(s){return t.style[e]}}};let se=t=>{var e={};return t&&"[object Function]"===e.toString.call(t)};"object"===typeof Int8Array||!Ut["default"].prototype.$isServer&&"function"===typeof document.childNodes||(se=function(t){return"function"===typeof t||!1});Object.prototype.hasOwnProperty;const ae=function(){return!Ut["default"].prototype.$isServer&&!!window.navigator.userAgent.match(/firefox/i)};function oe(t){let e=!1;return function(...i){e||(e=!0,window.requestAnimationFrame(s=>{t.apply(this,i),e=!1}))}}var ne=function(t){for(let e=1,i=arguments.length;e<i;e++){let i=arguments[e]||{};for(let e in i)if(i.hasOwnProperty(e)){let s=i[e];void 0!==s&&(t[e]=s)}}return t};let re,le=!1,ce=!1;const de=function(){if(Ut["default"].prototype.$isServer)return;let t=ue.modalDom;return t?le=!0:(le=!1,t=document.createElement("div"),ue.modalDom=t,t.addEventListener("touchmove",(function(t){t.preventDefault(),t.stopPropagation()})),t.addEventListener("click",(function(){ue.doOnModalClick&&ue.doOnModalClick()}))),t},he={},ue={modalFade:!0,getInstance:function(t){return he[t]},register:function(t,e){t&&e&&(he[t]=e)},deregister:function(t){t&&(he[t]=null,delete he[t])},nextZIndex:function(){return ue.zIndex++},modalStack:[],doOnModalClick:function(){const t=ue.modalStack[ue.modalStack.length-1];if(!t)return;const e=ue.getInstance(t.id);e&&e.closeOnClickModal&&e.close()},openModal:function(t,e,i,s,a){if(Ut["default"].prototype.$isServer)return;if(!t||void 0===e)return;this.modalFade=a;const o=this.modalStack;for(let r=0,l=o.length;r<l;r++){const e=o[r];if(e.id===t)return}const n=de();if(te(n,"v-modal"),this.modalFade&&!le&&te(n,"v-modal-enter"),s){let t=s.trim().split(/\s+/);t.forEach(t=>te(n,t))}setTimeout(()=>{ee(n,"v-modal-enter")},200),i&&i.parentNode&&11!==i.parentNode.nodeType?i.parentNode.appendChild(n):document.body.appendChild(n),e&&(n.style.zIndex=e),n.tabIndex=0,n.style.display="",this.modalStack.push({id:t,zIndex:e,modalClass:s})},closeModal:function(t){const e=this.modalStack,i=de();if(e.length>0){const s=e[e.length-1];if(s.id===t){if(s.modalClass){let t=s.modalClass.trim().split(/\s+/);t.forEach(t=>ee(i,t))}e.pop(),e.length>0&&(i.style.zIndex=e[e.length-1].zIndex)}else for(let i=e.length-1;i>=0;i--)if(e[i].id===t){e.splice(i,1);break}}0===e.length&&(this.modalFade&&te(i,"v-modal-leave"),setTimeout(()=>{0===e.length&&(i.parentNode&&i.parentNode.removeChild(i),i.style.display="none",ue.modalDom=void 0),ee(i,"v-modal-leave")},200))}};Object.defineProperty(ue,"zIndex",{configurable:!0,get(){return ce||(re=re||(Ut["default"].prototype.$ELEMENT||{}).zIndex||2e3,ce=!0),re},set(t){re=t}});const pe=function(){if(!Ut["default"].prototype.$isServer&&ue.modalStack.length>0){const t=ue.modalStack[ue.modalStack.length-1];if(!t)return;const e=ue.getInstance(t.id);return e}};Ut["default"].prototype.$isServer||window.addEventListener("keydown",(function(t){if(27===t.keyCode){const t=pe();t&&t.closeOnPressEscape&&(t.handleClose?t.handleClose():t.handleAction?t.handleAction("cancel"):t.close())}}));var me=ue;let ge;var fe=function(){if(Ut["default"].prototype.$isServer)return 0;if(void 0!==ge)return ge;const t=document.createElement("div");t.className="el-scrollbar__wrap",t.style.visibility="hidden",t.style.width="100px",t.style.position="absolute",t.style.top="-9999px",document.body.appendChild(t);const e=t.offsetWidth;t.style.overflow="scroll";const i=document.createElement("div");i.style.width="100%",t.appendChild(i);const s=i.offsetWidth;return t.parentNode.removeChild(t),ge=e-s,ge};let ve,ye=1;Boolean,Boolean,Boolean,Boolean,Boolean,Boolean,Boolean;const be={CONTAIN:{name:"contain",icon:"el-icon-full-screen"},ORIGINAL:{name:"original",icon:"el-icon-c-scale-to-original"}},_e=ae()?"DOMMouseScroll":"mousewheel";var we={name:"elImageViewer",props:{urlList:{type:Array,default:()=>[]},zIndex:{type:Number,default:2e3},onSwitch:{type:Function,default:()=>{}},onClose:{type:Function,default:()=>{}},initialIndex:{type:Number,default:0},appendToBody:{type:Boolean,default:!0},maskClosable:{type:Boolean,default:!0}},data(){return{index:this.initialIndex,isShow:!1,infinite:!0,loading:!1,mode:be.CONTAIN,transform:{scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}}},computed:{isSingle(){return this.urlList.length<=1},isFirst(){return 0===this.index},isLast(){return this.index===this.urlList.length-1},currentImg(){return this.urlList[this.index]},imgStyle(){const{scale:t,deg:e,offsetX:i,offsetY:s,enableTransition:a}=this.transform,o={transform:`scale(${t}) rotate(${e}deg)`,transition:a?"transform .3s":"","margin-left":i+"px","margin-top":s+"px"};return this.mode===be.CONTAIN&&(o.maxWidth=o.maxHeight="100%"),o},viewerZIndex(){const t=me.nextZIndex();return this.zIndex>t?this.zIndex:t}},watch:{index:{handler:function(t){this.reset(),this.onSwitch(t)}},currentImg(t){this.$nextTick(t=>{const e=this.$refs.img[0];e.complete||(this.loading=!0)})}},methods:{hide(){this.deviceSupportUninstall(),this.onClose()},deviceSupportInstall(){this._keyDownHandler=t=>{t.stopPropagation();const e=t.keyCode;switch(e){case 27:this.hide();break;case 32:this.toggleMode();break;case 37:this.prev();break;case 38:this.handleActions("zoomIn");break;case 39:this.next();break;case 40:this.handleActions("zoomOut");break}},this._mouseWheelHandler=oe(t=>{const e=t.wheelDelta?t.wheelDelta:-t.detail;e>0?this.handleActions("zoomIn",{zoomRate:.015,enableTransition:!1}):this.handleActions("zoomOut",{zoomRate:.015,enableTransition:!1})}),Jt(document,"keydown",this._keyDownHandler),Jt(document,_e,this._mouseWheelHandler)},deviceSupportUninstall(){Xt(document,"keydown",this._keyDownHandler),Xt(document,_e,this._mouseWheelHandler),this._keyDownHandler=null,this._mouseWheelHandler=null},handleImgLoad(t){this.loading=!1},handleImgError(t){this.loading=!1,t.target.alt="加载失败"},handleMouseDown(t){if(this.loading||0!==t.button)return;const{offsetX:e,offsetY:i}=this.transform,s=t.pageX,a=t.pageY;this._dragHandler=oe(t=>{this.transform.offsetX=e+t.pageX-s,this.transform.offsetY=i+t.pageY-a}),Jt(document,"mousemove",this._dragHandler),Jt(document,"mouseup",t=>{Xt(document,"mousemove",this._dragHandler)}),t.preventDefault()},handleMaskClick(){this.maskClosable&&this.hide()},reset(){this.transform={scale:1,deg:0,offsetX:0,offsetY:0,enableTransition:!1}},toggleMode(){if(this.loading)return;const t=Object.keys(be),e=Object.values(be),i=e.indexOf(this.mode),s=(i+1)%t.length;this.mode=be[t[s]],this.reset()},prev(){if(this.isFirst&&!this.infinite)return;const t=this.urlList.length;this.index=(this.index-1+t)%t},next(){if(this.isLast&&!this.infinite)return;const t=this.urlList.length;this.index=(this.index+1)%t},handleActions(t,e={}){if(this.loading)return;const{zoomRate:i,rotateDeg:s,enableTransition:a}={zoomRate:.2,rotateDeg:90,enableTransition:!0,...e},{transform:o}=this;switch(t){case"zoomOut":o.scale>.2&&(o.scale=parseFloat((o.scale-i).toFixed(3)));break;case"zoomIn":o.scale=parseFloat((o.scale+i).toFixed(3));break;case"clocelise":o.deg+=s;break;case"anticlocelise":o.deg-=s;break}o.enableTransition=a}},mounted(){this.deviceSupportInstall(),this.appendToBody&&document.body.appendChild(this.$el),this.$refs["el-image-viewer__wrapper"].focus()},destroyed(){this.appendToBody&&this.$el&&this.$el.parentNode&&this.$el.parentNode.removeChild(this.$el)}},Ce=we,xe=Object(h["a"])(Ce,Ft,Rt,!1,null,null,null),ke=xe.exports,Le=(i("0fae"),{data(){return{keyword:"",radio:!1,screenW:document.body.clientWidth,shows:!1,firstStep:!0,propsDataList:[],showBig:!1,showBigList:[],datalist0:[],isuserId:0,ishow:!1,isvipLimit:!0,show:!1,flag:!1,top:!1,colorSel:"#f5f9fA",loadingMore:!1,updateContent:!0,updateTopic:!0,giftBox:!1,giftBg:!1,userInfo:{},articleInfo:{},commentList:Et["b"],topicId:0,searchType:0,commentLastPage:!1,current:1,breadcrumbResp:{},collectState:!1,likeState:!1,floorUpdate:!1,fromType:"",isShowSetTopDom:!1,isShowDisCard:!1,sellMoney:0,dPlayer:null}},mixins:[yt,bt,_t["a"]],created(){this.init()},watch:{breadcrumbResp(t){console.log(t,"breadcrumbResp")}},mounted(){sessionStorage.getItem("bgColor")&&(document.querySelector(".details-box").style.backgroundColor=sessionStorage.getItem("bgColor"))},provide(){return{userInfo:this.userInfo}},computed:{AD_DETAILS_LLKEY(){return o["i"]},AD_DETAILS_LRKEY(){return o["j"]},AD_DETAILS_CTKEY(){return o["g"]},AD_DETAILS_CCKEY(){return o["e"]},AD_DETAILS_CBKEY(){return o["d"]},AD_DETAILS_LTKEY(){return o["k"]},AD_DETAILS_RTKEY(){return o["m"]},AD_DETAILS_LBKEY(){return o["h"]},AD_DETAILS_RBKEY(){return o["l"]}},methods:{handleCollect(t){t?this.$axios.get(b["a"]+"/favorite/v2/delete?entityType=topic&entityIds="+this.articleInfo.topicId).then(t=>{this.$message.success("帖子取消收藏成功"),this.articleInfo.folderId=null,this.get_posts()}).catch(t=>{this.$message.error(t)}):this.shows=!0},transfer(){this.radio?this.$axios.get(b["a"]+`/favorite/v2/add?entityType=topic&folderId=${this.radio}&entityId=${this.articleInfo.topicId}`).then(t=>{this.$message.success("帖子添加收藏成功"),this.get_posts(),this.articleInfo.folderId=!0,this.shows=!1}).catch(t=>{this.$message.error(t)}):this.$message.error("请选择收藏夹")},addSaveHttp(t){this.$axios.get(b["a"]+"/favorite/v2/folderAdd?folderId=0&folderName="+t).then(t=>{this.$message.success("收藏夹成功"),this.keyword="",this.get_posts()}).catch(t=>{this.$message.error(t)})},get_posts(t=null){let e=this;e.$store.state.isLogin&&e.$axios.get(b["a"]+"/favorite/v2/folderList").then(i=>{let s=[];if(i){let a=i.data;const o=a.filter(t=>"默认收藏夹"===t.name);s=a.filter(t=>"默认收藏夹"!==t.name),o[0]&&s.unshift(o[0]),t&&(s=s.filter(e=>e.id!=t)),s.map(t=>{Object.assign(t,{show:!1})}),e.datalist0=s}})},tagclick(t){console.log(t,"板块详情"),t.external_url?window.open(t.external_url):this.$router.push({path:"/article",query:{nodeId:t.nodeId}})},closeViewer(){this.showBig=!1},closeDiscountCard(){this.isShowDisCard=!1},setTopSuccess(t){this.articleInfo.is_top=!0,this.articleInfo.topExpiresTime=t},removeSetTopDom(){this.isShowSetTopDom=!1},showSetTop(){this.isShowSetTopDom=!0,this.$nextTick(()=>{this.$refs.setTopDialog.show=!0})},govip(){f["a"].get(f["a"].NOTLOGIN)?this.$loginWindow({reload:!0}):this.$router.push({name:"govip"})},searchTags(t){this.$router.push({path:"/es",query:{type:3,key:t}})},async stopReward(){try{await Object(n["e"])(this.articleInfo.topicId);this.$message.success("操作成功"),this.articleInfo.reward.is_expire=!1,this.articleInfo.reward.reward_status=1}catch(t){this.$message.error(t)}},async setReward(t){this.articleInfo.topicId,t.reply_id;try{y()({url:b["a"]+"/topic/reward",method:"post",data:j.a.stringify({topic_id:this.articleInfo.topicId,reply_id:t.reply_id}),headers:{"Content-Type":"application/x-www-form-urlencoded; charset=UTF-8"},timeout:1e4}).then(e=>{this.$message.success(`已将${t.floor+1}楼设置为最佳答案`),this.articleInfo.reward.is_expire=!1,this.articleInfo.reward.reward_status=2,this.articleInfo.reward.reward_reply_floor=t.floor}).catch(t=>{this.$message.error(t)})}catch(e){this.$message.error(e)}},toUserInfo(t){this.$router.push({name:"homepage_index",params:{uid:t}})},async init(){this.topicId=this.$route.query.pid,this.searchType=this.$route.query.search_type?this.$route.query.search_type:0;let t={topic_id:this.$route.query.pid,search_type:this.$route.query.search_type};if(this.topicId&&""!==this.topicId)try{const t=await xt(this.topicId);if(t){const e=t.node.vipLimit,i=this.$store.state;if(i.isLogin){const t=i.userInfo.vip;this.isvipLimit=!(t>=e||1==i.userInfo.role)}else this.isvipLimit=0!=e}this.articleInfo=t}catch(a){return void this.$router.push("/error")}if(f["a"].get(f["a"].NOTLOGIN)||""==f["a"].get(f["a"].NOTLOGIN))this.ishow=1;else{try{this.userInfo=this.$store.state.userInfo||{}}catch(a){}this.ishow=1}this.isvipLimit||(this.likeState=await Lt(t));let e=0;var i=this;async function s(){i.articleInfo&&Object.keys(i.articleInfo).length>0&&(0==i.$store.state.routerMenu.length&&e<10?(e++,setTimeout(()=>{s()},500)):i.breadcrumbResp=await Ct(i.$store.state.routerMenu,i.articleInfo.node))}s(),this.$route.query.reward&&(this.fromType="reward"),this.topicId&&""!==this.topicId&&!this.isvipLimit&&this.getReplyList(this.searchType),this.get_posts()},showBigImg(t){this.showBigList=[t],this.showBig=!0},async getReplyList(t){t!=this.searchType&&(this.searchType=t,this.current=1);try{let t=await kt({topic_id:this.topicId,search_type:this.searchType,page:this.current});if(t.data.page.total){let t=await Object(o["p"])(o["e"]);this.propsDataList=t.data}this.commentList=t.data,this.commentLastPage=t.commentLastPage,this.floorUpdate=!0;var e=this;this.$nextTick(()=>{setTimeout(()=>{let t=document.querySelectorAll(".floor_box img");t&&t.length>0&&t.forEach(t=>{t.getAttribute("data-id")&&t.setAttribute("title","点击查看大图")})},300);let t=document.querySelectorAll(".floor_box");t.length>0&&t.forEach(t=>{t.onclick=function(t){let i=t.target;if("IMG"==i.nodeName&&i.getAttribute("data-id")){let t=-1;i.parentNode.className&&-1!=i.parentNode.className.indexOf("floor_box")?t=i.parentNode.getAttribute("data-topicfloor"):i.parentNode.parentNode.className&&-1!=i.parentNode.parentNode.className.indexOf("floor_box")?t=i.parentNode.parentNode.getAttribute("data-topicfloor"):i.parentNode.parentNode.parentNode.className&&-1!=i.parentNode.parentNode.parentNode.className.indexOf("floor_box")?t=i.parentNode.parentNode.parentNode.getAttribute("data-topicfloor"):i.parentNode.parentNode.parentNode.parentNode.className&&-1!=i.parentNode.parentNode.parentNode.parentNode.className.indexOf("floor_box")&&(t=i.parentNode.parentNode.parentNode.parentNode.getAttribute("data-topicfloor")),-1!=t?f["a"].get(f["a"].NOTLOGIN)?e.$loginWindow({reload:!0}):"topic"==t&&e.articleInfo.user.certified&&e.articleInfo.user.id!=e.$store.state.userInfo.id&&0==e.$store.state.userInfo.vip?e.$confirm2("成为VIP才能查看大图","提示",{confirmButtonText:"成为VIP",cancelButtonText:"取消",showCancelButton:!0}).then(()=>{e.$router.push("/member")}).catch(()=>{}):"topic"!=t&&e.commentList.results[t].certified&&e.commentList.results[t].user_id!=e.$store.state.userInfo.id&&0==e.$store.state.userInfo.vip?e.$confirm2("成为VIP才能查看大图","提示",{confirmButtonText:"成为VIP",cancelButtonText:"取消",showCancelButton:!0}).then(()=>{e.$router.push("/member")}):e.showBigImg(i.src):e.showBigImg(i.src)}else{let t=i.getAttribute("data-uid"),s=i.getAttribute("data-door");i.getAttribute("data-book");i&&i.className&&i.className.indexOf&&-1!=i.className.indexOf("at-box")&&t?e.$router.push({name:"homepage_index",params:{uid:t}}):i&&i.className&&i.className.indexOf&&-1!=i.className.indexOf("door-box")&&s||i&&i.className&&i.className.indexOf&&i.className.indexOf("book-box")}}})})}catch(i){this.$message.error(i)}},showGift(t=0){f["a"].isLogon()?(this.isuserId=0==t?parseInt(this.articleInfo.user.id):t,this.giftBox=!0,this.giftBg=!0):this.$loginWindow({reload:!0})},giftHide(){this.giftBox=!1,setTimeout(()=>{this.giftBg=!1},300)},contentClick(t){if(t.target&&t.target.getAttribute("data-sell")){let e=t.target.getAttribute("data-sell");if(0==e)this.handleBuy(this.articleInfo,0,null);else{let t=document.querySelector('[data-floor-index="'+e+'"]'),i=t.getAttribute("data-floor-id"),s=t.getAttribute("data-floor-money");this.handleBuy(this.articleInfo,1,{reply_id:1*i,price:1*s})}}},scrollToReply(){if(f["a"].isLogon())try{window.scrollTo(0,document.body.scrollHeight),this.$refs.ed.$refs.myQuillEditor.quill.setSelection(0)}catch(t){}else this.$loginWindow({reload:!0})},changeTextarea(t,e=""){f["a"].isLogon()?(t.textareaObj.visibleTextarea||(t.textareaObj.visibleTextarea=!t.textareaObj.visibleTextarea),""!==e?(t.textareaObj.placeholder=`评论 ${e.nickname||""}：`,this.$set(t.textareaObj,"quote",e)):(t.textareaObj.placeholder="",t.textareaObj.quote={})):this.$loginWindow({reload:!0})},async postCommentSubmit(t,e){if(f["a"].isLogon())try{const i=this.$route.query.pid;let{textareaObj:s,reply_id:a}=t,{textareaContent:o,quote:r}=s,l=r&&r.commentId?r.commentId:0,c=await n["f"].call(this,{content:o,quote_id:l,reply_id:a,topic_id:Number(i)});console.log(c),s.visibleTextarea=!1,c.data&&c.data.reply_id?(t.textareaObj.textareaContent="",this.$message.success("提交成功，请稍后")):(t.textareaObj.textareaContent="",this.$message.success(0==l?"回复成功，审核中！":"评论成功，审核中！")),this.resetItemReply(e)}catch(i){this.$message.error(i.toString())}else this.$loginWindow({reload:!0})},async fetchItemReply(t,e,i){try{const s=await n["p"].call(this,{replyId:t,page:e+1});this.commentList.results[i].comment_list.page+=1,this.commentList.results[i].comment_list.list=this.commentList.results[i].comment_list.list.concat(s.data.results),this.commentList.results[i].comment_list.list.length===s.data.page.total&&(this.commentList.results[i].comment_list.lastPage=!0)}catch(s){}},resetItemReply(t){this.commentList.results[t].comment_list={list:[],page:0,lastPage:!1}},async onChangePagination(t,e){const i=this.$route.query.search_type,s=this.$route.query.pid;this.current=t,this.floorUpdate=!1;const a=await kt.call(this,{topic_id:s,search_type:i||0,page:this.current});this.$set(this.commentList,"results",a.data.results),this.$set(this.commentList,"page",a.data.page),this.commentLastPage=a.commentLastPage,this.floorUpdate=!0,setTimeout(()=>{window.scrollTo({top:0,left:0,behavior:"smooth"})},20)},changeBg(t){document.querySelector(".details-box").style.backgroundColor=t,sessionStorage.setItem("bgColor",t),this.colorSel=t},addArticle(t){f["a"].isLogon()?window.location.href="/addArticle?nodeId="+t:this.$loginWindow({reload:!0})}},components:{HjBreadcrumb:p,HjToolbar:g["a"],Tabs:m["a"],BbsTool:S,Editor:X,Emoji:Q["a"],giftPopup:Dt["a"],vipLimit:zt,topcardDialog:Z["a"],rankingList:ft,discountCard:At,ElImageViewer:ke}}),Ie=Le,Te=(i("6dec"),i("78396"),Object(h["a"])(Ie,s,a,!1,null,"7e04b972",null));e["default"]=Te.exports},eb38:function(t,e,i){"use strict";i("3f11")},fa38:function(t,e,i){"use strict";i("c3a2")},fded:function(t,e,i){"use strict";var s=function(){var t=this,e=t._self._c;return e("base-basic-layout",{attrs:{navOffsetX:t.navFixed?130:0,margin:10}},[e("div",{ref:"nav",staticClass:"hj-nav-second",class:t.navFixed&&"position-fixed",style:t.navFixed&&{top:"45px",left:t.navLeft+"px"},attrs:{slot:"layoutNav"},slot:"layoutNav"},[e("router-menu",{attrs:{"menu-list":t.$store.state.routerMenu||[]}})],1),e("div",{ref:"main",attrs:{slot:"layoutContent"},slot:"layoutContent"},[t._t("default")],2),e("div",{ref:"aside",class:t.AsideFixed&&"position-fixed",style:t.AsideFixed&&{top:`-${t.asideTop}px`,left:t.asideLeft+"px"},attrs:{slot:"layoutAside"},slot:"layoutAside"},[t._t("aside")],2)])},a=[],o=i("35e7"),n=i("ee57"),r=i("894b"),l=i("13ff"),c=i("c2e5"),d={mixins:[r["a"],l["a"],c["a"]],components:{BaseBasicLayout:o["a"],RouterMenu:n["a"]},mounted(){this.allOffsetLeft(),window.addEventListener("scroll",this._scrollEvent),window.addEventListener("resize",this._resizeEvent)},destroyed(){window.removeEventListener("scroll",this._scrollEvent),window.removeEventListener("resize",this._resizeEvent)},methods:{_resizeEvent(){this.allOffsetLeft()},_scrollEvent(){const t=document.documentElement.scrollTop||document.body.scrollTop;this.computedInfoFlowNav(t),this.isNavLock(t),this.isAsideLock(t)}},watch:{menuList(t){"ssr"!==this.platform&&this.$emit("routerData",this.menuList)}}},h=d,u=i("2877"),p=Object(u["a"])(h,s,a,!1,null,null,null);e["a"]=p.exports}}]);